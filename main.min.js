var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},NetSecondPage=function(){function e(e){this.scene=e,this.group_secondPage=e.group_secondPage}return e.prototype.loginInterceptor=function(){var e=this.scene.mediator.player.isLogin();return e||(this.hideAllSecondPage(),this.popLoginView()),e},e.prototype.hideAllSecondPage=function(){this.group_secondPage.removeChildren()},e.prototype.popSecondPage=function(){},e.prototype.popGiveUpDialog=function(){var e=this.scene.mediator.room;if(e&&e.roomStatus==con.roomStatus.gamestart){this.hideAllSecondPage();var t=new GiveUpDialog(this);t.horizontalCenter=0,t.verticalCenter=0,this.group_secondPage.addChild(t)}},e.prototype.popSuePeaceDialog=function(e){var t=this.scene.mediator.room;if(t&&t.roomStatus==con.roomStatus.gamestart){this.hideAllSecondPage();var i=new SuePeaceDialog(this);i.horizontalCenter=0,i.verticalCenter=0,i.popSuePeace(e),this.group_secondPage.addChild(i)}},e.prototype.popGameOverView=function(){this.victoryView=new VictoryView(this),this.group_secondPage.addChild(this.victoryView)},e.prototype.popLoginView=function(){this.loginView||(this.loginView=new NetLoginView(this)),this.loginView.init(),this.group_secondPage.addChild(this.loginView)},e.prototype.popFindPwdView=function(){this.findPwdView||(this.findPwdView=new FindPwdView(this)),this.findPwdView.init(),this.group_secondPage.addChild(this.findPwdView)},e.prototype.popRegisterView=function(){this.registerView||(this.registerView=new RegisterView(this)),this.registerView.init(),this.group_secondPage.addChild(this.registerView)},e.prototype.popPersonalView=function(){this.personalView||(this.personalView=new PersonalView(this)),this.personalView.refreshPlayerInfo(),this.group_secondPage.addChild(this.personalView)},e.prototype.popEditPlayerInfoView=function(){this.editPlayerInfoView=new EditPlayerInfoView(this),this.personalView.refreshPlayerInfo(),this.group_secondPage.addChild(this.editPlayerInfoView)},e.prototype.popNetIndexView=function(){this.netIndexView||(this.netIndexView=new NetIndexView(this)),this.netIndexView.getPlayerNum(),this.group_secondPage.addChild(this.netIndexView)},e.prototype.popRoomView=function(){this.roomView||(this.roomView=new NetRoomView(this),this.roomView.name="roomView"),this.roomView.refreshRoomInfo();var e=this.group_secondPage.getChildByName("roomView");e||this.group_secondPage.addChild(this.roomView)},e.prototype.popChatView=function(){this.hideAllSecondPage(),this.chatView||(this.chatView=new NetChatView(this)),this.chatView.setPlayerChatMsg(),this.group_secondPage.addChild(this.chatView)},e.prototype.popMenuView=function(){this.menuView||(this.menuView=new NetMenuView(this)),this.menuView.refreshMenuButton(),this.group_secondPage.addChild(this.menuView)},e.prototype.popRuleView=function(){this.ruleView||(this.ruleView=new NetRuleView),this.group_secondPage.addChild(this.ruleView),this.ruleView.stage.frameRate=60},e.prototype.popStatisticsView=function(){this.statisticsView||(this.statisticsView=new StatisticsView(this)),this.statisticsView.statisticsKilledChessNum(),this.group_secondPage.addChild(this.statisticsView)},e.prototype.registerRet=function(e){this.registerView&&this.registerView.registerRet(e)},e.prototype.findBackPwdRet=function(e){this.findPwdView&&this.findPwdView.findPwdRet(e)},e}();__reflect(NetSecondPage.prototype,"NetSecondPage");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function s(s){t.call(i,s,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?s(r):RES.getResAsync(e,s,this)}else RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var CheckRule=function(){function e(e){this.mediator=null,this.mediator=e}return e.prototype.checkOverChess=function(e,t){var i=this.mediator.chessAttr,s=!1,r=i.getChessObjByChess(e[t]);return r.type==con.chessType.cover&&(s=!0),s},e.prototype.checkVictory=function(e,t,i){var s=this.mediator.chessAttr,r=con.victoryStatus.win;if(i>=1e3)return r=con.victoryStatus.draw;var o=con.getOppositeCamp(t),n=0,h=0,a=0,p=0,u=null,c=null,l=[],g=-1,d=!0,y=con.positionGraph;for(h=0;60>h;h++){if(l=y[h],u=s.getChessObjByChess(e[h]),u.type===con.chessType.cover)return r=con.victoryStatus.playing;if(o===u.camp){if(u.moveType!==con.moveType.unable&&r!==con.victoryStatus.playing)for(p=l.length,a=0;p>a;a++)if(g=l[a],c=s.getChessObjByChess(e[g]),d=c.type===con.chessType.kong?!0:con.isKillChessObj(u,c)){r=con.victoryStatus.playing;break}}else u.moveType!==con.moveType.unable&&n++}return r!==con.victoryStatus.playing&&(r=t===con.camp.red?con.victoryStatus.redwin:con.victoryStatus.bluewin),0===n&&(r=t===con.camp.red?con.victoryStatus.bluewin:con.victoryStatus.redwin),r},e.prototype.checkSelSource=function(e,t,i){var s=this.mediator.chessAttr,r=!1,o=s.getChessObjByChess(e[t]),n=o.camp,h=o.moveType;return r=n==i&&h!=con.moveType.unable?!0:!1},e.prototype.checkSelTarget=function(e,t,i){var s=this.mediator.chessAttr,r=!1,o=s.getChessObjByChess(e[t]),n=o.camp,h=o.moveType,a=o.type;return r=a===con.chessType.kong?!0:n===i&&h!=con.moveType.unable?!1:!0},e.prototype.checkMoveChess=function(e,t,i,s){function r(){if(m==_&&(l=[0]),m>_+20)for(w=0;w<c.length;w++)for(C=0;C<l.length;C++)l[C]===c[w]&&l.splice(C,1);return 2===l.length&&(l.indexOf(60)>-1&&l.indexOf(61)>-1||l.indexOf(54)>-1&&l.indexOf(55)>-1)?!1:!0}function o(){if(8===con.positionGraph[s].length){if(0!==e[s][0])return!1;if(_===con.chessType.rZha||_===con.chessType.bZha)return!1}return!0}function n(){var t=!1,r=PathSearch.Shared(),o=con.isNextPosition(i,s);switch(v.moveType){case con.moveType.unable:T="选择的棋子不能移动",t=!1;break;case con.moveType.oneStep:o?(t=!0,P.push(i),P.push(s)):t=!1;break;case con.moveType.line:if(o)t=!0,P.push(i),P.push(s);else{var n=r.linePath(e,i,s);n.isMove?(t=!0,P=n.path):t=!1}break;case con.moveType.curve:if(o)t=!0,P.push(i),P.push(s);else{var h=r.curvePath(e,i,s);h.isMove?(t=!0,P=h.path):t=!1}break;default:t=!1}return t}function h(){var e=v.kills;for(G=e.length,w=0;G>w;w++){if(e[w][0]===f){L=e[w][1];break}if(w===G-1)return!1}if(L>_+20)for(w=0;w<g.length;w++)c.splice(0,0,g[w]);if(_-20>L&&L>=20){var t=_-L;for(w=0;w<c.length;w++)if(Math.abs(c[w]-t)<=2){c.splice(w,1);break}}0==L&&(c=[0]);var i=a.getChessObjByChess(l);if(!i)return!1;var s=a.getChessObjByChess(c);return s?!0:!1}var a=this.mediator.chessAttr,p=Util,u={selectArr:null,success:null,path:null,souLoc:null,sourceArr:null,tarLoc:null,targetArr:null},c=p.clone(t)||[];u.selectArr=p.clone(c);var l=p.clone(e[i]),g=p.clone(e[s]),d=p.sumArray(c),y=p.sumArray(l),b=p.sumArray(g),_=con.chessCtMap[d],m=con.chessCtMap[y],f=con.chessCtMap[b],v=a.ctObjMap[_],L=(a.ctObjMap[m],a.ctObjMap[f],0),P=[],G=0,w=0,C=0,T="";return f===con.chessType.kong?u.success=r()&&n()&&o():u.success=r()&&n()&&o()&&h(),u.path=P,u.souLoc=i,u.sourceArr=l,u.tarLoc=s,u.targetArr=c,u},e}();__reflect(CheckRule.prototype,"CheckRule");var ChessAttr=function(){function e(){this.Kong={},this.Cover={},this.BLeader={},this.BJun={},this.BShi={},this.BLv={},this.BTuan={},this.BYing={},this.BLian={},this.BPai={},this.BGong={},this.BZha={},this.BLei={},this.BQi={},this.RLeader={},this.RJun={},this.RShi={},this.RLv={},this.RTuan={},this.RYing={},this.RLian={},this.RPai={},this.RGong={},this.RZha={},this.RLei={},this.RQi={},this.BPai_rZha={},this.RPai_bZha={},this.BPai_rZha2={},this.RPai_bZha2={},this.BGong_rQi={},this.RQi_rLei={},this.BGong_rLei={},this.RLei2={},this.BGong_rQi_rLei={},this.RQi_rLei2={},this.BGong_rLei2={},this.RLei3={},this.BGong_rQi_rLei2={},this.RQi_rLei3={},this.BGong_rLei3={},this.BGong_rQi_rLei3={},this.RGong_bQi={},this.BQi_bLei={},this.RGong_bLei={},this.BLei2={},this.RGong_bQi_bLei={},this.BQi_bLei2={},this.RGong_bLei2={},this.BLei3={},this.RGong_bQi_bLei2={},this.BQi_bLei3={},this.RGong_bLei3={},this.RGong_bQi_bLei3={},this.ctObjMap=null,this.init(),this.initCtAttrMap()}return e.prototype.initCtAttrMap=function(){var e=this;this.ctObjMap={0:e.Kong,500:e.Cover,49:e.BLeader,50:e.BJun,26:e.BShi,28:e.BLv,30:e.BTuan,32:e.BYing,23:e.BLian,20:e.BPai,51:e.BGong,54:e.BZha,67:e.BLei,59:e.BQi,65:e.RLeader,66:e.RJun,40:e.RShi,42:e.RLv,44:e.RTuan,46:e.RYing,34:e.RLian,37:e.RPai,62:e.RGong,60:e.RZha,56:e.RLei,48:e.RQi,80:e.BPai_rZha,91:e.RPai_bZha,141:e.BPai_rZha2,146:e.RPai_bZha2,99:e.BGong_rQi,104:e.RQi_rLei,107:e.BGong_rLei,113:e.RLei2,155:e.BGong_rQi_rLei,161:e.RQi_rLei2,164:e.BGong_rLei2,171:e.RLei3,212:e.BGong_rQi_rLei2,219:e.RQi_rLei3,222:e.BGong_rLei3,270:e.BGong_rQi_rLei3,121:e.RGong_bQi,126:e.BQi_bLei,129:e.RGong_bLei,135:e.BLei2,188:e.RGong_bQi_bLei,194:e.BQi_bLei2,197:e.RGong_bLei2,204:e.BLei3,256:e.RGong_bQi_bLei2,263:e.BQi_bLei3,266:e.RGong_bLei3,325:e.RGong_bQi_bLei3}},e.prototype.getChessObjByChess=function(e){var t=0;t=Util.isArray(e)?Util.sumArray(e):e;var i=con.chessCtMap[t];return this.ctObjMap[i]},e.prototype.init=function(){function e(){this.type=et.kong,this.camp=tt.neutral,this.moveType=it.unable,this.isGroup=!1,this.description="";var e=new Array;this.kills=e}function t(){this.type=et.cover,this.camp=tt.neutral,this.moveType=it.unable,this.isGroup=!1,this.description="";var e=new Array;this.kills=e}function i(){this.type=et.bLeader,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="司令";var e=new Array;this.kills=e,e.push([et.rLeader,0]),e.push([et.rJun,this.type]),e.push([et.rShi,this.type]),e.push([et.rLv,this.type]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.rGong,this.type])}function s(){this.type=et.bJun,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="军长";var e=new Array;this.kills=e,e.push([et.rJun,0]),e.push([et.rShi,this.type]),e.push([et.rLv,this.type]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.rGong,this.type])}function r(){this.type=et.bShi,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="师长";var e=new Array;this.kills=e,e.push([et.rShi,0]),e.push([et.rLv,this.type]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.rGong,this.type])}function o(){this.type=et.bLv,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="旅长";var e=new Array;this.kills=e,e.push([et.rLv,0]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.rGong,this.type])}function n(){this.type=et.bTuan,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="团长";var e=new Array;this.kills=e,e.push([et.rTuan,0]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.rGong,this.type])}function h(){this.type=et.bYing,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="营长";var e=new Array;this.kills=e,e.push([et.rYing,0]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.rGong,this.type])}function a(){this.type=et.bLian,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="连长";var e=new Array;this.kills=e,e.push([et.rLian,0]),e.push([et.rPai,this.type]),e.push([et.rGong,this.type])}function p(){this.type=et.bPai,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!1,this.description="排长";var e=new Array;this.kills=e,e.push([et.rPai,0]),e.push([et.rGong,this.type]),e.push([et.rZha,et.bPai_rZha]),e.push([et.rPai_bZha,0]),e.push([et.rPai_bZha2,0])}function u(){this.type=et.bGong,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!1,this.description="工兵";var e=new Array;this.kills=e,e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rLei,et.bGong_rLei]),e.push([et.rLei2,et.bGong_rLei2]),e.push([et.rLei3,et.bGong_rLei3]),e.push([et.rQi,et.bGong_rQi]),e.push([et.rQi_rLei,et.bGong_rQi]),e.push([et.rQi_rLei2,et.bGong_rQi_rLei2]),e.push([et.rQi_rLei3,et.bGong_rQi_rLei3])}function c(){this.type=et.bZha,this.camp=tt.blue,this.moveType=it.line,this.isGroup=!1,this.description="炸弹";var e=new Array;this.kills=e,e.push([et.rZha,0]),e.push([et.rLeader,0]),e.push([et.rJun,0]),e.push([et.rShi,0]),e.push([et.rLv,0]),e.push([et.rTuan,0]),e.push([et.rYing,0]),e.push([et.rLian,0]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rLei,0]),e.push([et.rLei2,0]),e.push([et.rLei3,0]),e.push([et.rQi,0]),e.push([et.rQi_rLei,0]),e.push([et.rQi_rLei2,0]),e.push([et.rQi_rLei3,0]),e.push([et.bLei,0]),e.push([et.bLei2,0]),e.push([et.bLei3,0]),e.push([et.bQi,0]),e.push([et.bQi_bLei,0]),e.push([et.bQi_bLei2,0]),e.push([et.bQi_bLei3,0])}function l(){this.type=et.bLei,this.camp=tt.blue,this.moveType=it.unable,this.isGroup=!1,this.description="地雷";var e=new Array;this.kills=e}function g(){this.type=et.bQi,this.camp=tt.blue,this.moveType=it.unable,this.isGroup=!1,this.description="军旗";var e=new Array;this.kills=e}function d(){this.type=et.bGong_rQi,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,this.type]),e.push([et.rJun,this.type]),e.push([et.rShi,this.type]),e.push([et.rLv,this.type]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rLei,et.bGong_rQi_rLei]),e.push([et.rLei2,et.bGong_rQi_rLei2]),e.push([et.rLei3,et.bGong_rQi_rLei3])}function y(){this.type=et.rQi_rLei,this.camp=tt.red,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function b(){this.type=et.bGong_rLei,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,et.bGong]),e.push([et.rJun,et.bGong]),e.push([et.rShi,et.bGong]),e.push([et.rLv,et.bGong]),e.push([et.rTuan,et.bGong]),e.push([et.rYing,et.bGong]),e.push([et.rLian,et.bGong]),e.push([et.rPai,et.bGong]),e.push([et.bLei,et.bGong]),e.push([et.bQi,et.bGong]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rLei,et.bGong_rLei2]),e.push([et.rLei2,et.bGong_rLei3]),e.push([et.rQi,et.bGong_rQi_rLei]),e.push([et.rQi_rLei,et.bGong_rQi_rLei2]),e.push([et.rQi_rLei2,et.bGong_rQi_rLei3])}function _(){this.type=et.rLei2,this.camp=tt.red,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function m(){this.type=et.bGong_rQi_rLei,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,this.type]),e.push([et.rJun,this.type]),e.push([et.rShi,this.type]),e.push([et.rLv,this.type]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.bLei,et.bGong_rQi]),e.push([et.bQi,et.bGong_rQi]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rLei,et.bGong_rQi_rLei2]),e.push([et.rLei2,et.bGong_rQi_rLei3])}function f(){this.type=et.rQi_rLei2,this.camp=tt.red,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function v(){this.type=et.bGong_rLei2,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,et.bGong_rLei]),e.push([et.rJun,et.bGong_rLei]),e.push([et.rShi,et.bGong_rLei]),e.push([et.rLv,et.bGong_rLei]),e.push([et.rTuan,et.bGong_rLei]),e.push([et.rYing,et.bGong_rLei]),e.push([et.rLian,et.bGong_rLei]),e.push([et.rPai,et.bGong_rLei]),e.push([et.bLei,et.bGong_rLei]),e.push([et.bQi,et.bGong_rLei]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rLei,et.bGong_rLei3]),e.push([et.rQi,et.bGong_rQi_rLei2]),e.push([et.rQi_rLei,et.bGong_rQi_rLei3])}function L(){this.type=et.rLei3,this.camp=tt.red,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function P(){this.type=et.bGong_rQi_rLei2,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,this.type]),e.push([et.rJun,this.type]),e.push([et.rShi,this.type]),e.push([et.rLv,this.type]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.bLei,et.bGong_rQi_rLei]),e.push([et.bQi,et.bGong_rQi_rLei]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rLei,et.bGong_rQi_rLei3])}function G(){this.type=et.rQi_rLei3,this.camp=tt.red,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function w(){this.type=et.bGong_rLei3,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,et.bGong_rLei2]),e.push([et.rJun,et.bGong_rLei2]),e.push([et.rShi,et.bGong_rLei2]),e.push([et.rLv,et.bGong_rLei2]),e.push([et.rTuan,et.bGong_rLei2]),e.push([et.rYing,et.bGong_rLei2]),e.push([et.rLian,et.bGong_rLei2]),e.push([et.rPai,et.bGong_rLei2]),e.push([et.bLei,et.bGong_rLei2]),e.push([et.bQi,et.bGong_rLei2]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0]),e.push([et.rQi,et.bGong_rQi_rLei3])}function C(){this.type=et.bGong_rQi_rLei3,this.camp=tt.blue,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,this.type]),e.push([et.rJun,this.type]),e.push([et.rShi,this.type]),e.push([et.rLv,this.type]),e.push([et.rTuan,this.type]),e.push([et.rYing,this.type]),e.push([et.rLian,this.type]),e.push([et.rPai,this.type]),e.push([et.bLei,et.bGong_rQi_rLei2]),e.push([et.bQi,et.bGong_rQi_rLei2]),e.push([et.rGong,0]),e.push([et.rGong_bLei,0]),e.push([et.rGong_bLei2,0]),e.push([et.rGong_bLei3,0]),e.push([et.rGong_bQi,0]),e.push([et.rGong_bQi_bLei,0]),e.push([et.rGong_bQi_bLei2,0]),e.push([et.rGong_bQi_bLei3,0])}function T(){this.type=et.bPai_rZha,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,et.bPai]),e.push([et.rJun,et.bPai]),e.push([et.rShi,et.bPai]),e.push([et.rLv,et.bPai]),e.push([et.rTuan,et.bPai]),e.push([et.rYing,et.bPai]),e.push([et.rLian,et.bPai]),e.push([et.rPai,0]),e.push([et.rPai_bZha,0]),e.push([et.rPai_bZha2,0]),e.push([et.rZha,et.bPai_rZha2]),e.push([et.rGong,this.type]),e.push([et.rGong_bLei,et.bPai]),e.push([et.rGong_bLei2,et.bPai]),e.push([et.rGong_bLei3,et.bPai]),e.push([et.rGong_bQi,et.bPai]),e.push([et.rGong_bQi_bLei,et.bPai]),e.push([et.rGong_bQi_bLei2,et.bPai]),e.push([et.rGong_bQi_bLei3,et.bPai]),e.push([et.rLei,et.bPai]),e.push([et.rLei2,et.bPai]),e.push([et.rLei3,et.bPai]),e.push([et.rQi,et.bPai]),e.push([et.rQi_rLei,et.bPai]),e.push([et.rQi_rLei2,et.bPai]),e.push([et.rQi_rLei3,et.bPai]),e.push([et.bLei,et.bPai]),e.push([et.bLei2,et.bPai]),e.push([et.bLei3,et.bPai]),e.push([et.bQi,et.bPai]),e.push([et.bQi_bLei,et.bPai]),e.push([et.bQi_bLei2,et.bPai]),e.push([et.bQi_bLei3,et.bPai])}function S(){this.type=et.bPai_rZha2,this.camp=tt.blue,this.moveType=it.oneStep,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.rLeader,et.bPai_rZha]),e.push([et.rJun,et.bPai_rZha]),e.push([et.rShi,et.bPai_rZha]),e.push([et.rLv,et.bPai_rZha]),e.push([et.rTuan,et.bPai_rZha]),e.push([et.rYing,et.bPai_rZha]),e.push([et.rLian,et.bPai_rZha]),e.push([et.rPai,0]),e.push([et.rPai_bZha,0]),e.push([et.rPai_bZha2,0]),e.push([et.rGong,this.type]),e.push([et.rGong_bLei,et.bPai_rZha]),e.push([et.rGong_bLei2,et.bPai_rZha]),e.push([et.rGong_bLei3,et.bPai_rZha]),e.push([et.rGong_bQi,et.bPai_rZha]),e.push([et.rGong_bQi_bLei,et.bPai_rZha]),e.push([et.rGong_bQi_bLei2,et.bPai_rZha]),e.push([et.rGong_bQi_bLei3,et.bPai_rZha]),e.push([et.rLei,et.bPai_rZha]),e.push([et.rLei2,et.bPai_rZha]),e.push([et.rLei3,et.bPai_rZha]),e.push([et.rQi,et.bPai_rZha]),e.push([et.rQi_rLei,et.bPai_rZha]),e.push([et.rQi_rLei2,et.bPai_rZha]),e.push([et.rQi_rLei3,et.bPai_rZha]),e.push([et.bLei,et.bPai_rZha]),e.push([et.bLei2,et.bPai_rZha]),e.push([et.bLei3,et.bPai_rZha]),e.push([et.bQi,et.bPai_rZha]),e.push([et.bQi_bLei,et.bPai_rZha]),e.push([et.bQi_bLei2,et.bPai_rZha]),e.push([et.bQi_bLei3,et.bPai_rZha])}function R(){this.type=et.rLeader,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="司令";var e=new Array;this.kills=e,e.push([et.bLeader,0]),e.push([et.bJun,this.type]),e.push([et.bShi,this.type]),e.push([et.bLv,this.type]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.bGong,this.type])}function x(){this.type=et.rJun,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="军长";var e=new Array;this.kills=e,e.push([et.bJun,0]),e.push([et.bShi,this.type]),e.push([et.bLv,this.type]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.bGong,this.type])}function F(){this.type=et.rShi,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="师长";var e=new Array;this.kills=e,e.push([et.bShi,0]),e.push([et.bLv,this.type]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.bGong,this.type])}function A(){this.type=et.rLv,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="旅长";var e=new Array;this.kills=e,e.push([et.bLv,0]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.bGong,this.type])}function Q(){this.type=et.rTuan,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="团长";var e=new Array;this.kills=e,e.push([et.bTuan,0]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.bGong,this.type])}function k(){this.type=et.rYing,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="营长";var e=new Array;this.kills=e,e.push([et.bYing,0]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.bGong,this.type])}function E(){this.type=et.rLian,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="连长";var e=new Array;this.kills=e,e.push([et.bLian,0]),e.push([et.bPai,this.type]),e.push([et.bGong,this.type])}function V(){this.type=et.rPai,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!1,this.description="排长";var e=new Array;this.kills=e,e.push([et.bPai,0]),e.push([et.bGong,this.type]),e.push([et.bZha,et.rPai_bZha]),e.push([et.bPai_rZha,0]),e.push([et.bPai_rZha2,0])}function O(){this.type=et.rGong,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!1,this.description="工兵";var e=new Array;this.kills=e,e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bLei,et.rGong_bLei]),e.push([et.bLei2,et.rGong_bLei2]),e.push([et.bLei3,et.rGong_bLei3]),e.push([et.bQi,et.rGong_bQi]),e.push([et.bQi_bLei,et.rGong_bQi]),e.push([et.bQi_bLei2,et.rGong_bQi_bLei2]),e.push([et.bQi_bLei3,et.rGong_bQi_bLei3])}function I(){this.type=et.rZha,this.camp=tt.red,this.moveType=it.line,this.isGroup=!1,this.description="炸弹";var e=new Array;this.kills=e,e.push([et.bZha,0]),e.push([et.bLeader,0]),e.push([et.bJun,0]),e.push([et.bShi,0]),e.push([et.bLv,0]),e.push([et.bTuan,0]),e.push([et.bYing,0]),e.push([et.bLian,0]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bLei,0]),e.push([et.bLei2,0]),e.push([et.bLei3,0]),e.push([et.bQi,0]),e.push([et.bQi_bLei,0]),e.push([et.bQi_bLei2,0]),e.push([et.bQi_bLei3,0]),e.push([et.rLei,0]),e.push([et.rLei2,0]),e.push([et.rLei3,0]),e.push([et.rQi,0]),e.push([et.rQi_rLei,0]),e.push([et.rQi_rLei2,0]),e.push([et.rQi_rLei3,0])}function M(){this.type=et.rLei,this.camp=tt.red,this.moveType=it.unable,this.isGroup=!1,this.description="地雷";var e=new Array;this.kills=e}function N(){this.type=et.rQi,this.camp=tt.red,this.moveType=it.unable,this.isGroup=!1,this.description="军旗";var e=new Array;this.kills=e}function B(){this.type=et.rGong_bQi,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,this.type]),e.push([et.bJun,this.type]),e.push([et.bShi,this.type]),e.push([et.bLv,this.type]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bLei,et.rGong_bQi_bLei]),e.push([et.bLei2,et.rGong_bQi_bLei2]),e.push([et.bLei3,et.rGong_bQi_bLei3])}function D(){this.type=et.bQi_bLei,this.camp=tt.blue,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function Z(){this.type=et.rGong_bLei,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,et.rGong]),e.push([et.bJun,et.rGong]),e.push([et.bShi,et.rGong]),e.push([et.bLv,et.rGong]),e.push([et.bTuan,et.rGong]),e.push([et.bYing,et.rGong]),e.push([et.bLian,et.rGong]),e.push([et.bPai,et.rGong]),e.push([et.rLei,et.rGong]),e.push([et.rQi,et.rGong]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bLei,et.rGong_bLei2]),e.push([et.bLei2,et.rGong_bLei3]),e.push([et.bQi,et.rGong_bQi_bLei]),e.push([et.bQi_bLei,et.rGong_bQi_bLei2]),e.push([et.bQi_bLei2,et.rGong_bQi_bLei3])}function H(){this.type=et.bLei2,this.camp=tt.blue,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function U(){this.type=et.rGong_bQi_bLei,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,this.type]),e.push([et.bJun,this.type]),e.push([et.bShi,this.type]),e.push([et.bLv,this.type]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.rLei,et.rGong_bQi]),e.push([et.rQi,et.rGong_bQi]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bLei,et.rGong_bQi_bLei2]),e.push([et.bLei2,et.rGong_bQi_bLei3])}function W(){this.type=et.bQi_bLei2,this.camp=tt.blue,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function Y(){this.type=et.rGong_bLei2,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,et.rGong_bLei]),e.push([et.bJun,et.rGong_bLei]),e.push([et.bShi,et.rGong_bLei]),e.push([et.bLv,et.rGong_bLei]),e.push([et.bTuan,et.rGong_bLei]),e.push([et.bYing,et.rGong_bLei]),e.push([et.bLian,et.rGong_bLei]),e.push([et.bPai,et.rGong_bLei]),e.push([et.rLei,et.rGong_bLei]),e.push([et.rQi,et.rGong_bLei]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bLei,et.rGong_bLei3]),e.push([et.bQi,et.rGong_bQi_bLei2]),e.push([et.bQi_bLei,et.rGong_bQi_bLei3])}function z(){this.type=et.bLei3,this.camp=tt.blue,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function J(){this.type=et.rGong_bQi_bLei2,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,this.type]),e.push([et.bJun,this.type]),e.push([et.bShi,this.type]),e.push([et.bLv,this.type]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.rLei,et.rGong_bQi_bLei]),e.push([et.rQi,et.rGong_bQi_bLei]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bLei,et.rGong_bQi_bLei3])}function j(){this.type=et.bQi_bLei3,this.camp=tt.blue,this.moveType=it.unable,this.isGroup=!0;var e=new Array;this.kills=e}function X(){this.type=et.rGong_bLei3,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,et.rGong_bLei2]),e.push([et.bJun,et.rGong_bLei2]),e.push([et.bShi,et.rGong_bLei2]),e.push([et.bLv,et.rGong_bLei2]),e.push([et.bTuan,et.rGong_bLei2]),e.push([et.bYing,et.rGong_bLei2]),e.push([et.bLian,et.rGong_bLei2]),e.push([et.bPai,et.rGong_bLei2]),e.push([et.rLei,et.rGong_bLei2]),e.push([et.rQi,et.rGong_bLei2]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0]),e.push([et.bQi,et.rGong_bQi_bLei3])}function q(){this.type=et.rGong_bQi_bLei3,this.camp=tt.red,this.moveType=it.curve,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,this.type]),e.push([et.bJun,this.type]),e.push([et.bShi,this.type]),e.push([et.bLv,this.type]),e.push([et.bTuan,this.type]),e.push([et.bYing,this.type]),e.push([et.bLian,this.type]),e.push([et.bPai,this.type]),e.push([et.rLei,et.rGong_bQi_bLei2]),e.push([et.rQi,et.rGong_bQi_bLei2]),e.push([et.bGong,0]),e.push([et.bGong_rLei,0]),e.push([et.bGong_rLei2,0]),e.push([et.bGong_rLei3,0]),e.push([et.bGong_rQi,0]),e.push([et.bGong_rQi_rLei,0]),e.push([et.bGong_rQi_rLei2,0]),e.push([et.bGong_rQi_rLei3,0])}function $(){this.type=et.rPai_bZha,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,et.rPai]),e.push([et.bJun,et.rPai]),e.push([et.bShi,et.rPai]),e.push([et.bLv,et.rPai]),e.push([et.bTuan,et.rPai]),e.push([et.bYing,et.rPai]),e.push([et.bLian,et.rPai]),e.push([et.bPai,0]),e.push([et.bPai_rZha,0]),e.push([et.bPai_rZha2,0]),e.push([et.bZha,et.rPai_bZha2]),e.push([et.bGong,this.type]),e.push([et.bGong_rLei,et.rPai]),e.push([et.bGong_rLei2,et.rPai]),e.push([et.bGong_rLei3,et.rPai]),e.push([et.bGong_rQi,et.rPai]),e.push([et.bGong_rQi_rLei,et.rPai]),e.push([et.bGong_rQi_rLei2,et.rPai]),e.push([et.bGong_rQi_rLei3,et.rPai]),e.push([et.bLei,et.rPai]),e.push([et.bLei2,et.rPai]),e.push([et.bLei3,et.rPai]),e.push([et.bQi,et.rPai]),e.push([et.bQi_bLei,et.rPai]),e.push([et.bQi_bLei2,et.rPai]),e.push([et.bQi_bLei3,et.rPai]),e.push([et.rLei,et.rPai]),e.push([et.rLei2,et.rPai]),e.push([et.rLei3,et.rPai]),e.push([et.rQi,et.rPai]),e.push([et.rQi_rLei,et.rPai]),e.push([et.rQi_rLei2,et.rPai]),e.push([et.rQi_rLei3,et.rPai])
}function K(){this.type=et.rPai_bZha2,this.camp=tt.red,this.moveType=it.oneStep,this.isGroup=!0;var e=new Array;this.kills=e,e.push([et.bLeader,et.rPai_bZha]),e.push([et.bJun,et.rPai_bZha]),e.push([et.bShi,et.rPai_bZha]),e.push([et.bLv,et.rPai_bZha]),e.push([et.bTuan,et.rPai_bZha]),e.push([et.bYing,et.rPai_bZha]),e.push([et.bLian,et.rPai_bZha]),e.push([et.bPai,0]),e.push([et.bPai_rZha,0]),e.push([et.bPai_rZha2,0]),e.push([et.bGong,this.type]),e.push([et.bGong_rLei,et.rPai_bZha]),e.push([et.bGong_rLei2,et.rPai_bZha]),e.push([et.bGong_rLei3,et.rPai_bZha]),e.push([et.bGong_rQi,et.rPai_bZha]),e.push([et.bGong_rQi_rLei,et.rPai_bZha]),e.push([et.bGong_rQi_rLei2,et.rPai_bZha]),e.push([et.bGong_rQi_rLei3,et.rPai_bZha]),e.push([et.bLei,et.rPai_bZha]),e.push([et.bLei2,et.rPai_bZha]),e.push([et.bLei3,et.rPai_bZha]),e.push([et.bQi,et.rPai_bZha]),e.push([et.bQi_bLei,et.rPai_bZha]),e.push([et.bQi_bLei2,et.rPai_bZha]),e.push([et.bQi_bLei3,et.rPai_bZha]),e.push([et.rLei,et.rPai_bZha]),e.push([et.rLei2,et.rPai_bZha]),e.push([et.rLei3,et.rPai_bZha]),e.push([et.rQi,et.rPai_bZha]),e.push([et.rQi_rLei,et.rPai_bZha]),e.push([et.rQi_rLei2,et.rPai_bZha]),e.push([et.rQi_rLei3,et.rPai_bZha])}var et=con.chessType,tt=con.camp,it=con.moveType;this.Kong=new e,this.Cover=new t,this.BLeader=new i,this.BJun=new s,this.BShi=new r,this.BLv=new o,this.BTuan=new n,this.BYing=new h,this.BLian=new a,this.BPai=new p,this.BGong=new u,this.BZha=new c,this.BLei=new l,this.BQi=new g,this.RLeader=new R,this.RJun=new x,this.RShi=new F,this.RLv=new A,this.RTuan=new Q,this.RYing=new k,this.RLian=new E,this.RPai=new V,this.RGong=new O,this.RZha=new I,this.RLei=new M,this.RQi=new N,this.BPai_rZha=new T,this.RPai_bZha=new $,this.BPai_rZha2=new S,this.RPai_bZha2=new K,this.BGong_rQi=new d,this.RQi_rLei=new y,this.BGong_rLei=new b,this.RLei2=new _,this.BGong_rQi_rLei=new m,this.RQi_rLei2=new f,this.BGong_rLei2=new v,this.RLei3=new L,this.BGong_rQi_rLei2=new P,this.RQi_rLei3=new G,this.BGong_rLei3=new w,this.BGong_rQi_rLei3=new C,this.RGong_bQi=new B,this.BQi_bLei=new D,this.RGong_bLei=new Z,this.BLei2=new H,this.RGong_bQi_bLei=new U,this.BQi_bLei2=new W,this.RGong_bLei2=new Y,this.BLei3=new z,this.RGong_bQi_bLei2=new J,this.BQi_bLei3=new j,this.RGong_bLei3=new X,this.RGong_bQi_bLei3=new q},e}();__reflect(ChessAttr.prototype,"ChessAttr");var NetworkMediator=function(){function e(){this.chessAttr=new ChessAttr,this.checkRule=new CheckRule(this),this.serverIO=new ServerIO(this),this.room=null,this.player=new Player(this)}return e.prototype.initScene=function(e){this.scene=e},e.prototype.createRoom=function(e){var t=this.room;return t||(t=new Room(this,e),this.room=t),e&&(t.id=e),t},e.prototype.initRoomInfo=function(e){this.deleteRoom();var t=this.createRoom(e.id);return e&&t.initRoomInfo(e),t},e.prototype.isMeByPlayerName=function(e){return this.player.name===e?!0:!1},e.prototype.isMeByPlayer=function(e){return this.player===e?!0:!1},e.prototype.deleteRoom=function(){var e=this.room;e&&(e.deleteRoom(),this.room=null)},e.prototype.login=function(e,t){var i={name:e,pwd:t};this.loginOut(),this.serverIO.login(i)},e.prototype.findBackPwd=function(e){this.serverIO.findBackPwd(e)},e.prototype.findBackPwdRet=function(e){this.scene.secondPage.findBackPwdRet(e)},e.prototype.loginOut=function(){this.deleteRoom(),this.player.loginOut(),this.serverIO.loginOut()},e.prototype.loginRet=function(e){e.success&&this.player.login(e),this.scene.loginRet(e)},e.prototype.register=function(e){this.serverIO.register(e)},e.prototype.registerRet=function(e){this.scene.secondPage.registerRet(e)},e.prototype.reLoginRet=function(){this.scene.reLoginRet()},e.prototype.enterRoom=function(e){this.room?this.scene.enterRoomRet():this.serverIO.enterRoom(e)},e.prototype.enterRoomRet=function(e){var t=e.id,i=e.playerName,s=e.userInfo,r=e.roomInfo;r&&this.initRoomInfo(r),this.room||this.createRoom(t),this.room.playerEnterRoom(i,s),this.scene.enterRoomRet()},e.prototype.ready=function(){this.player.playerStatus===con.playerStatus.notReady&&this.serverIO.ready(null)},e.prototype.readyRet=function(e){e.playerName&&(this.room&&this.room.playerReady(e.playerName),this.scene.readyRet())},e.prototype.changeRoom=function(){this.serverIO.changeRoom(null)},e.prototype.leaveRoom=function(){this.serverIO.leaveRoom(null)},e.prototype.leaveRoomRet=function(e){if(this.room){var t=e.playerName;if(t){var i=this.isMeByPlayerName(t);i?(this.player.leaveRoom(),this.deleteRoom()):this.room.playerLeaveRoom(t),this.scene.leaveRoomRet(i)}}},e.prototype.startGameRet=function(e){e&&(this.room.gameStartInit(),this.room.gameStart(e),this.scene.startGameRet())},e.prototype.overChess=function(){var e=this.player,t={loc:e.sourceLoc};this.serverIO.overChess(t)},e.prototype.overChessRet=function(e){if(e.success){var t=this.room;if(t){var i=t.overChess(e);i&&this.scene.overChessRet(e)}}},e.prototype.moveChess=function(){var e=this.player,t={sourceLoc:e.sourceLoc,targetLoc:e.targetLoc,selectChessArr:e.selectChessArr};this.serverIO.moveChess(t)},e.prototype.moveChessRet=function(e){if(e&&e.success){var t=this.room;if(t){var i=t.moveChess(e);i&&this.scene.moveChessRet(e)}}},e.prototype.gameOverRet=function(e){if(e&&e.victoryStatus){var t=this.room;t&&(t.gameOver(e.victoryStatus),this.scene.gameOverRet())}},e.prototype.syncRoomState=function(){this.serverIO.syncRoomState()},e.prototype.syncRoomStateRet=function(e){var t=e.roomInfo;if(t&&t.id){if(this.initRoomInfo(t),this.room.roomStatus===con.roomStatus.gamestart){var i={player1Name:t.player1.name,player2Name:t.player2.name,isPlayering1:t.player1.isPlaying,isPlayering2:t.player2.isPlaying};this.room.gameStart(i),this.scene.startGameRet()}}else this.deleteRoom()},e.prototype.giveUp=function(){this.serverIO.giveUp(null)},e.prototype.suePeace=function(e,t){var i=(this.player,{isSuePeace:e,isRequest:t});this.serverIO.suePeace(i)},e.prototype.suePeaceRet=function(e){if(e){var t=this.room;if(t){var i=e.isRequest;this.isMeByPlayerName(e.playerName);this.scene.suePeaceRet(i)}}},e.prototype.outTImeRet=function(e){e&&e.hostCamp&&this.room.playerOutTime(e.hostCamp)},e.prototype.chat=function(e){if(e){var t={msg:e};this.serverIO.chat(t)}},e.prototype.chatRet=function(e){e&&(this.room&&this.room.addPlayerChatMsg(e),this.scene.chatRet(e))},e.prototype.readyTimeRet=function(e){e&&this.room&&this.room.playerOutTime(e.hostCamp)},e.prototype.hostPlayerTimingServerRet=function(e){e&&this.room.hostPlayerTimingServer(e)},e.prototype.disconnect=function(){this.deleteRoom(),this.scene.disconnect()},e.prototype.clickChessGroup=function(e){var t=this.player,i=this.scene,s=this.room;if(s&&s.chessboard){var r=s.chessboard;if(e.selectChessArr.length>0)return e.selectChessGroup(!1),void(t.sourceLoc=-1);i.hideAllChessGroupSelectChessPanel();var o=e.loc,n=this.checkRule;if(t.isPlaying){if(n.checkOverChess(r,o))return t.sourceLoc=o,void this.overChess();if(t.camp!=con.camp.neutral){if(!n.checkSelTarget(r,o,t.camp))return void(n.checkSelSource(r,o,t.camp)?(i.cancleAllSelectChessGroup(),t.sourceLoc=o,t.selectChessArr=Util.clone(r[o]),e.selectChessGroup(!0)):t.sourceLoc=-1);if(-1!=t.sourceLoc){var h=n.checkMoveChess(r,t.selectChessArr,t.sourceLoc,o);if(h.success)return t.targetLoc=o,void this.moveChess()}}-1===t.sourceLoc&&i.cancleAllSelectChessGroup()}}},e.prototype.cancleAllSelectChessGroup=function(){var e=this.player;e.cancleAllSelectChess()},e.prototype.addSelectChess=function(e){var t=this.player;t.addSelectChess(e)},e.prototype.outSelectChess=function(e){var t=this.player;t.outSelectChess(e)},e.prototype.refreshSceneLabelMsg=function(){this.scene.refreshMsg()},e.prototype.refreshRoomView=function(){this.scene.refreshRoomInfo()},e}();__reflect(NetworkMediator.prototype,"NetworkMediator");var Player=function(){function e(e){this.name=null,this.userInfo=null,this.loginUser=null,this.room=null,this.disconnTimerId=0,this.readyTimerId=0,this.disconnTimeCount=0,this.maxWaitTime=30,this.readyTimeCount=0,this.mediator=e,this.init()}return e.prototype.init=function(){this.sourceLoc=-1,this.targetLoc=-1,this.selectChessArr=[],this.isPlaying=!1,this.camp=con.camp.neutral,this.playerStatus=con.victoryStatus.playing,this.loginStatus=con.loginStatus.logout,this.victoryStatus=con.victoryStatus.playing,this.playerRole=con.playerRole.visitor},e.prototype.initPlayerState=function(e){this.name=e.name,this.camp=e.camp,this.isPlaying=e.isPlaying,this.playerStatus=e.playerStatus,this.loginStatus=e.loginStatus,this.victoryStatus=e.victoryStatus,this.playerRole=e.playerRole;var t=e.readyStartTime,i=e.nowTime;t>0&&(this.readyTimeCount=this.maxWaitTime-Math.floor((i-t)/1e3),this.setReadyTimer()),e.userInfo&&(this.userInfo=e.userInfo)},e.prototype.setUserInfo=function(e){this.userInfo=e},e.prototype.getPlayerInfo=function(){var e={name:this.name,userInfo:this.userInfo,camp:this.camp,isPlaying:this.isPlaying,playerStatus:this.playerStatus,loginStatus:this.loginStatus,victoryStatus:this.victoryStatus,playerRole:this.playerRole};return e},e.prototype.addSelectChess=function(e){-1==this.selectChessArr.indexOf(e)&&this.selectChessArr.push(e)},e.prototype.outSelectChess=function(e){var t=this.selectChessArr.indexOf(e);t>-1&&this.selectChessArr.splice(t,1)},e.prototype.cancleAllSelectChess=function(){this.selectChessArr=[]},e.prototype.login=function(e){this.loginStatus=con.loginStatus.login,this.name=e.name,this.userInfo=e.userInfo,this.loginUser=e.loginUser},e.prototype.loginOut=function(){this.loginStatus=con.loginStatus.disconnect,this.name=""},e.prototype.isLogin=function(){return this.loginStatus===con.loginStatus.login&&""!=this.name?!0:!1},e.prototype.enterRoom=function(e){this.room=e,this.isPlaying=!1,this.playerRole=con.playerRole.player,this.playerStatus=con.playerStatus.notReady,this.readyTimeCount=30,this.setReadyTimer()},e.prototype.leaveRoom=function(){this.room=null,this.camp=con.camp.neutral,this.isPlaying=!1,this.playerStatus=con.playerStatus.undistributed,this.victoryStatus=con.victoryStatus.playing,this.playerRole=con.playerRole.visitor,this.claerReadyTimer()},e.prototype.ready=function(){this.camp=con.camp.neutral,this.isPlaying=!1,this.playerStatus=con.playerStatus.ready},e.prototype.notReady=function(){this.camp=con.camp.neutral,this.isPlaying=!1,this.playerStatus=con.playerStatus.notReady,this.readyTimeCount=30,this.setReadyTimer()},e.prototype.gameStart=function(e){this.sourceLoc=-1,this.targetLoc=-1,this.selectChessArr=[],this.isPlaying=e,this.playerStatus=con.playerStatus.start,this.victoryStatus=con.victoryStatus.playing},e.prototype.overChess=function(){},e.prototype.moveChess=function(){},e.prototype.gameOver=function(e){var t=con.victoryStatus.playing;this.camp===con.camp.blue?(e===con.victoryStatus.draw&&(t=con.victoryStatus.draw),e===con.victoryStatus.bluewin&&(t=con.victoryStatus.win),e===con.victoryStatus.redwin&&(t=con.victoryStatus.lose)):(e===con.victoryStatus.draw&&(t=con.victoryStatus.draw),e===con.victoryStatus.bluewin&&(t=con.victoryStatus.lose),e===con.victoryStatus.redwin&&(t=con.victoryStatus.win)),this.sourceLoc=-1,this.targetLoc=-1,this.selectChessArr=[],this.isPlaying=!1,this.playerStatus=con.playerStatus.notReady,this.victoryStatus=t},e.prototype.setDisconnTimer=function(e){var t=this;this.claerDisconnTimer();var i=this.room;i&&(this.readyTimeCount=90,this.disconnTimerId=setInterval(function(){t.disconnTimerId=0,this.readyTimeCount--,e()},1e3))},e.prototype.claerDisconnTimer=function(){this.disconnTimerId&&(clearInterval(this.disconnTimerId),this.disconnTimerId=0)},e.prototype.setReadyTimer=function(){if(this.playerStatus==con.playerStatus.notReady){var e=this,t=this.room;this.claerReadyTimer(),this.readyTimeing(),this.readyTimerId=setInterval(function(){e.readyTimeing(),e.readyTimeCount<=0&&(e.claerReadyTimer(),t&&t.playerLeaveRoom(e.name))},1e3)}},e.prototype.readyTimeing=function(){this.playerStatus===con.playerStatus.notReady&&(this.readyTimeCount--,this.room&&this.mediator.refreshRoomView())},e.prototype.claerReadyTimer=function(){this.readyTimerId&&(clearInterval(this.readyTimerId),this.readyTimerId=0)},e.prototype.clearAllTimer=function(){this.claerReadyTimer(),this.claerDisconnTimer()},e.prototype.getVictoryRate=function(){if(!this.userInfo)return 0;var e=this.userInfo.winCount,t=this.userInfo.loseCount,i=this.userInfo.drawCount,s=0;if(!e)return 0;s+=e,t&&(s+=t),i&&(s+=i);var r=e/s*100;return r},e.prototype.getVictoryRateStr=function(){var e=this.getVictoryRate(),t=e.toFixed(2)+"%";return t},e}();__reflect(Player.prototype,"Player");var Room=function(){function e(e,t){this.createChessArr=[],this.chessboard=[],this.player1=null,this.player2=null,this.stepNum=0,this.no=0,this.hostCamp=con.camp.neutral,this.defaultWaitTime=30,this.maxWaitTime=this.defaultWaitTime,this.victoryStatus=con.victoryStatus.playing,this.roomStatus=con.roomStatus.waitplayer,this.hostPlayerTimeCount=0,this.playerChatMsgArr=[],this.mediator=e,this.id=t}return e.prototype.initRoomInfo=function(e){this.id=e.id,this.createChessArr=e.createChessArr,this.chessboard=e.chessboard,this.stepNum=e.stepNum,this.no=e.no,this.hostCamp=e.hostCamp,this.victoryStatus=e.victoryStatus,this.roomStatus=e.roomStatus,this.hostPlayerTimeCount=e.hostPlayerTimeCount,e.player1&&(this.player1=this.createPlayer(e.player1.name,e.player1,null)),e.player2&&(this.player2=this.createPlayer(e.player2.name,e.player2,null))},e.prototype.deleteRoom=function(){this.clearTimers(),this.player1&&this.player1.leaveRoom(),this.player2&&this.player2.leaveRoom()},e.prototype.initState=function(){this.stepNum=0,this.no=0,this.hostCamp=con.camp.neutral,this.maxWaitTime=this.defaultWaitTime,this.victoryStatus=con.victoryStatus.playing,this.roomStatus=con.roomStatus.waitplayer,this.createChessArr=[],this.chessboard=[]},e.prototype.initChessboard=function(){this.createChessArr=[];var e=0,t=con.chessType.cover,i=con.positionGraph;for(e=20;70>e;e++)this.createChessArr[e-20]=e;for(e=0;60>e;e++)i[e].length<8?this.chessboard[e]=[t]:this.chessboard[e]=[0]},e.prototype.initTestChessboard=function(){this.createChessArr=[];var e=0;con.chessType.cover,con.positionGraph;for(e=20;70>e;e++)this.createChessArr[e-20]=e;for(e=0;60>e;e++)this.chessboard[e]=[0];this.chessboard[0]=[20],this.chessboard[1]=[21],this.chessboard[2]=[22],this.chessboard[3]=[38],this.chessboard[4]=[39],this.chessboard[5]=[37],this.chessboard[6]=[54],this.chessboard[7]=[55],this.chessboard[8]=[60],this.chessboard[9]=[61],this.chessboard[10]=[51],this.chessboard[11]=[52],this.chessboard[12]=[53],this.chessboard[13]=[62],this.chessboard[14]=[63],this.chessboard[15]=[64],this.chessboard[16]=[500]},e.prototype.changeHostCamp=function(){this.hostCamp=con.getOppositeCamp(this.hostCamp)},e.prototype.getOppositePlayer=function(e){return e==this.player1?this.player2:this.player1},e.prototype.getHostPlayer=function(){return this.player1&&this.player1.isPlaying?this.player1:this.player2&&this.player2.isPlaying?this.player2:null},e.prototype.getPlayerByName=function(e){return this.player1&&this.player1.name===e?this.player1:this.player2&&this.player2.name===e?this.player2:null},e.prototype.setHostPlayer=function(e){this.hostCamp=e,this.player1&&this.player2&&this.hostCamp!==con.camp.neutral&&(this.player1.camp===this.hostCamp&&(this.player1.isPlaying=!0,this.player2.isPlaying=!1),this.player2.camp===this.hostCamp&&(this.player1.isPlaying=!1,this.player2.isPlaying=!0)),this.hostPlayerTimeCount=this.maxWaitTime},e.prototype.createPlayer=function(e,t,i){var s=null;return e===this.mediator.player.name?s=this.mediator.player:(s=new Player(this.mediator),s.name=e),t&&s.initPlayerState(t),i&&s.setUserInfo(i),s},e.prototype.playerEnterRoom=function(e,t){if(e){this.playerLeaveRoom(e);var i=this.createPlayer(e,null,t);t&&i.setUserInfo(t),null===this.player1?this.player1=i:null===this.player2&&(this.player2=i),i.enterRoom(this)}},e.prototype.playerLeaveRoom=function(e){var t=this.getPlayerByName(e);t&&(t.leaveRoom(),this.player1===t&&(this.player1=null),this.player2===t&&(this.player2=null))},e.prototype.playerReady=function(e){var t=this.getPlayerByName(e);t&&t.ready()},e.prototype.playerNotReady=function(e){var t=this.getPlayerByName(e);t&&t.notReady()},e.prototype.gameStartInit=function(){this.stepNum=0,this.no=0,this.initChessboard(),this.hostCamp=con.camp.neutral,this.maxWaitTime=this.defaultWaitTime,this.victoryStatus=con.victoryStatus.playing,this.roomStatus=con.roomStatus.gamestart,this.hostPlayerTimeCount=this.maxWaitTime},e.prototype.gameStart=function(e){var t=e.player1Name,i=e.player2Name,s=e.isPlayering1,r=e.isPlayering2,o=this.getPlayerByName(t),n=this.getPlayerByName(i);o.gameStart(s),n.gameStart(r)},e.prototype.overChess=function(e){if(!e)return!1;var t=this.getPlayerByName(e.playerName);if(!t)return!1;if(t.sourceLoc=-1,t.targetLoc=-1,t.selectChessArr=[],this.chessboard[e.loc]=[e.chess],Util.delArrSameVal(this.createChessArr,e.chess),this.stepNum++,1===this.stepNum){var i=this.mediator.chessAttr.getChessObjByChess(e.chess).camp;t.camp=i;var s=this.getOppositePlayer(t);s.camp=con.getOppositeCamp(i)}return this.setHostPlayer(e.hostCamp),!0},e.prototype.moveChess=function(e){if(!e)return!1;var t=this.getPlayerByName(e.playerName);return t?(this.victoryStatus=e.victoryStatus,this.chessboard[e.souLoc]=e.sourceArr,this.chessboard[e.tarLoc]=e.targetArr,this.stepNum++,this.setHostPlayer(e.hostCamp),!0):!1},e.prototype.gameOver=function(e){e>0&&8>e&&(this.victoryStatus=e,this.roomStatus=con.roomStatus.waitplayer,this.hostCamp=con.camp.neutral,this.maxWaitTime=this.defaultWaitTime,this.player1&&this.player1.gameOver(e),this.player2&&this.player2.gameOver(e))},e.prototype.playerOutTime=function(e){0===this.stepNum&&(this.player1&&(this.player1.isPlaying=!this.player1.isPlaying),this.player2&&(this.player2.isPlaying=!this.player2.isPlaying)),this.setHostPlayer(e)},e.prototype.setPlayerTimer=function(){this.clearPlayerTimer();var e=this;(0!==this.stepNum||this.mediator.player.isPlaying)&&this.roomStatus==con.roomStatus.gamestart&&(this.timeoutId=setInterval(function(){e.playerTiming()},1e3),this.playerTiming())},e.prototype.clearPlayerTimer=function(){this.timeoutId&&clearInterval(this.timeoutId)},e.prototype.playerTiming=function(){return this.roomStatus!=con.roomStatus.gamestart?void this.clearPlayerTimer():(this.mediator.refreshSceneLabelMsg(),void this.hostPlayerTimeCount--)},e.prototype.clearTimers=function(){this.clearPlayerTimer()},e.prototype.hostPlayerTimingServer=function(e){e&&(this.hostCamp=e.hostCamp,this.hostPlayerTimeCount=e.timeCount,this.mediator.refreshSceneLabelMsg())},e.prototype.addPlayerChatMsg=function(e){var t=e.playerName,i=e.chatMsg;this.playerChatMsgArr.push({playerName:t,chatMsg:i,time:new Date})},e}();__reflect(Room.prototype,"Room");var ServerIO=function(){function e(e){this.mediator=null,this.serverUrl="https://chengxg.leanapp.cn",this.socket=null,this.mediator=e}return e.prototype.connectToServer=function(){this.socket||(this.socket=io.connect(this.serverUrl),this.initIOLisener())},e.prototype.disconnectToServer=function(){this.socket&&(this.socket.disconnect(),this.socket=null)},e.prototype.isConnect=function(){},e.prototype.login=function(e){this.connectToServer(),this.socket.emit("login",e)},e.prototype.loginOut=function(){this.disconnectToServer()},e.prototype.loginRet=function(){var e=this;this.socket.on("login",function(t){console.log("loginRet"+JSON.stringify(t)),e.mediator.loginRet(t)})},e.prototype.reLoginRet=function(){var e=this;this.socket.on("relogin",function(){console.log("relogin"),e.mediator.reLoginRet()})},e.prototype.register=function(e){this.connectToServer(),this.socket.emit("register",e)},e.prototype.registerRet=function(){var e=this;this.socket.on("register",function(t){console.log("register"+JSON.stringify(t)),e.mediator.registerRet(t)})},e.prototype.findBackPwd=function(e){this.connectToServer(),this.socket.emit("findBackPwd",e)},e.prototype.findBackPwdRet=function(){var e=this;this.socket.on("findBackPwd",function(t){console.log("findBackPwd"+JSON.stringify(t)),e.mediator.findBackPwdRet(t)})},e.prototype.editPlayerInfo=function(e,t){this.connectToServer(),this.socket.emit("editPlayerInfo",e);this.socket.once("editPlayerInfo",function(e){console.log("editPlayerInfo"+JSON.stringify(e)),t&&"function"==typeof t&&t(e)})},e.prototype.enterRoom=function(e){this.socket.emit("enterRoom",e)},e.prototype.enterRoomRet=function(){var e=this;this.socket.on("enterRoom",function(t){console.log("enterRoomRet"+JSON.stringify(t)),e.mediator.enterRoomRet(t)})},e.prototype.ready=function(e){this.socket.emit("ready",e)},e.prototype.readyRet=function(){var e=this;this.socket.on("ready",function(t){console.log("readyRet"+JSON.stringify(t)),e.mediator.readyRet(t)})},e.prototype.changeRoom=function(e){this.socket.emit("changeRoom",e)},e.prototype.leaveRoom=function(e){this.socket.emit("leaveRoom",e)},e.prototype.leaveRoomRet=function(){var e=this;this.socket.on("playerLeaveRoom",function(t){console.log("playerLeaveRoom"+JSON.stringify(t)),e.mediator.leaveRoomRet(t)})},e.prototype.startGameRet=function(){var e=this;this.socket.on("startGame",function(t){console.log("startGame"+JSON.stringify(t)),e.mediator.startGameRet(t)})},e.prototype.overChess=function(e){this.socket.emit("overChess",e)},e.prototype.overChessRet=function(){var e=this;this.socket.on("overChess",function(t){console.log("overChessRet"+JSON.stringify(t)),e.mediator.overChessRet(t)})},e.prototype.moveChess=function(e){this.socket.emit("moveChess",e)},e.prototype.moveChessRet=function(){var e=this;this.socket.on("moveChess",function(t){console.log("moveChess"+JSON.stringify(t)),e.mediator.moveChessRet(t)})},e.prototype.gameOverRet=function(){var e=this;this.socket.on("gameOver",function(t){console.log("gameOver"+JSON.stringify(t)),e.mediator.gameOverRet(t)})},e.prototype.syncRoomState=function(){this.socket.emit("syncRoomState",null)},e.prototype.syncRoomStateRet=function(){var e=this;this.socket.on("syncRoomState",function(t){console.log("syncRoomState"+JSON.stringify(t)),e.mediator.syncRoomStateRet(t)})},e.prototype.playerOutTime=function(){var e=this;this.socket.on("outTime",function(t){console.log("playerOutTime"+JSON.stringify(t)),e.mediator.outTImeRet(t)})},e.prototype.giveUp=function(e){this.socket.emit("giveUp",e)},e.prototype.suePeace=function(e){this.socket.emit("suePeace",e)},e.prototype.suePeaceRet=function(){var e=this;this.socket.on("suePeace",function(t){console.log("suePeace"+JSON.stringify(t)),e.mediator.suePeaceRet(t)})},e.prototype.chat=function(e){this.socket.emit("chat",e)},e.prototype.chatRet=function(){var e=this;this.socket.on("chat",function(t){console.log("chatRet"+JSON.stringify(t)),e.mediator.chatRet(t)})},e.prototype.readyTimeRet=function(){var e=this;this.socket.on("readyTime",function(t){console.log("readyTime"+JSON.stringify(t)),e.mediator.chatRet(t)})},e.prototype.hostPlayerTimingServerRet=function(){var e=this;this.socket.on("playing",function(t){e.mediator.hostPlayerTimingServerRet(t)})},e.prototype.playerNum=function(e,t){this.socket.emit("playerNum",e);this.socket.on("playerNum",function(e){console.log("playerNum"+JSON.stringify(e)),t&&"function"==typeof t&&t(e)})},e.prototype.initIOLisener=function(){var e=this;this.socket.on("connect",function(){e.loginRet(),e.reLoginRet(),e.registerRet(),e.findBackPwdRet(),e.enterRoomRet(),e.readyRet(),e.leaveRoomRet(),e.startGameRet(),e.overChessRet(),e.moveChessRet(),e.gameOverRet(),e.syncRoomStateRet(),e.playerOutTime(),e.suePeaceRet(),e.chatRet(),e.hostPlayerTimingServerRet(),console.log("连接成功")}),this.socket.on("connecting",function(){console.log("正在连接")}),this.socket.on("disconnect",function(){console.log("与服务其断开"),e.mediator.disconnect()}),this.socket.on("reconnect",function(){console.log("重新连接到服务器")}),this.socket.on("connect_failed",function(){console.log("重新连接到服务器")}),this.socket.on("reconnect_failed",function(){console.log("重新连接到服务器失败")}),this.socket.on("error",function(e){console.log("发生错误"+e)}),this.socket.on("reconnecting",function(t){e.mediator.scene.setToastMsg("正在重新连接到服务器..."),console.log("正在重新连接"+t)})},e}();__reflect(ServerIO.prototype,"ServerIO");var PathSearch=function(){function e(){var e=[];e.push([0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1]),e.push([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0]),this.edges=e,this.vertexList=[5,6,7,8,9,10,14,15,19,20,24,25,26,27,28,29,30,31,32,33,34,35,39,40,44,45,49,50,51,52,53,54],this.numOfVertex=this.vertexList.length}return e.Shared=function(){return null==e.shared&&(e.shared=new e),e.shared},e.prototype.curvePath=function(e,t,i){var s={isMove:null,path:null},r=this.vertexList,o=this.numOfVertex,n=-1,h=-1,a=new Array(o),p=[];this.path=p;var u=new Array(o);this.chessList=u;for(var c=0;o>c;c++)a[c]=!1,u[c]=e[r[c]][0];if(n=r.indexOf(t),h=r.indexOf(i),this.endVertex=h,-1===n||-1===h)return s.isMove=!1,s.path=[],s;u[n]=1,u[h]=1,p.push(h),s.isMove=this.privateDepthFirstSearch(a,n),p.push(n);for(var c=0;c<p.length;c++)p[c]=r[p[c]];return p.reverse(),s.path=p,s},e.prototype.privateDepthFirstSearch=function(e,t){e[t]=!0;for(var i=this.getFirstNeighbor(t);-1!=i;){if(i==this.endVertex)return!0;if(!e[i]&&0==this.chessList[i]&&this.privateDepthFirstSearch(e,i))return this.path.push(i),!0;i=this.getNextNeighbor(t,i)}return!1},e.prototype.getFirstNeighbor=function(e){for(var t=0;t<this.numOfVertex;t++)if(this.edges[e][t]>0)return t;return-1},e.prototype.getNextNeighbor=function(e,t){for(var i=t+1;i<this.numOfVertex;i++)if(this.edges[e][i]>0)return i;return-1},e.prototype.linePath=function(e,t,i){var s=Math.floor(t%5),r=Math.floor(t/5),o=Math.floor(i%5),n=Math.floor(i/5),h=0,a=[],p=!1;if(a.push(5*r+s),s==o&&(0==s||4==s))if(r>=n)for(h=r-1;h>n;h--){if(0!=e[5*h+s][0]){p=!1;break}a.push(5*h+s),p=!0}else for(h=r+1;n>h;h++){if(0!=e[5*h+s][0]){p=!1;break}a.push(5*h+s),p=!0}if(r==n&&(1==r||5==r||6==r||10==r))if(s>=o)for(h=s-1;h>o;h--){if(0!=e[5*r+h][0]){p=!1;break}a.push(5*r+h),p=!0}else for(h=s+1;o>h;h++){if(0!=e[5*r+h][0]){p=!1;break}a.push(5*r+h),p=!0}return s==o&&2==s&&(5==r&&6==n||6==r&&5==n)&&(p=!0),a.push(5*n+o),{isMove:p,path:a}},e}();__reflect(PathSearch.prototype,"PathSearch");var Util=function(){function e(){}return e.isType=function(e){return Object.prototype.toString.call(e).slice(8,-1)},e.isObject=function(t){return"Object"===e.isType(t)},e.isArray=function(t){return"Array"===e.isType(t)},e.isFunction=function(t){return"Function"===e.isType(t)},e.extend=function(t,i){if(e.isObject(t)||e.isFunction(t)&&e.isObject(i))for(var s in i)i.hasOwnProperty(s)&&(e.isObject(i[s])?t[s]=e.extend({},i[s]):e.isArray(i[s])?t[s]=e.extend([],i[s]):t[s]=i[s]);else if(e.isArray(t)&&e.isArray(i))for(var r=0,o=i.length;o>r;r++)t.push(i[r]);return t},e.clone=function(t){return e.isObject(t)?e.extend({},t):e.isArray(t)?e.extend([],t):t},e.sumArray=function(t){var i=0;if(e.isArray(t))for(var s=0;s<t.length;s++)i+=t[s];return i},e.toggleValOfArray=function(e,t){var i=e.indexOf(t);-1==i?e.push(t):e.splice(i,1)},e.delArrSameVal=function(t,i){var s=0,r=0;for(e.isArray(i)||(i=[i]),s=0;s<i.length;s++)for(r=0;r<t.length;r++)t[r]===i[s]&&t.splice(r,1)},e}();__reflect(Util.prototype,"Util");var AboutView=function(e){function t(){var t=e.call(this)||this;t.skinName="src/game/scenes/AboutViewSkin.exml";var i=ChessboardPara.Shared();t.width=i.chessboardW,t.height=i.chessboardH,t.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,t.removeThis,t);var s=32,r=28,o=16748544,n=16777215;return t.label_content.textFlow=[{text:"简介:\n",style:{size:s,textColor:o,bold:!0}},{text:"      ”工兵扛军旗“是我们几个小伙伴改良的一种玩法,此种玩法以杀光对方所有棋子为目标,展开的攻防作战。与主流的玩法存在一些不同点，如:除工兵、炸弹外的普通棋子只能一步一步的走，特定棋子可以组合为棋子组，军旗被扛不再是胜负的条件，而是变成杀人的工具。\n      “请大家多多支持，最后希望此玩法能够得到更多的人认可！\n",style:{size:r,textColor:n}},{text:"\n当前版本:",style:{size:s,textColor:o,bold:!0}},{text:"  1.0.0\n",style:{size:r,textColor:n}},{text:"\n反馈邮箱:",style:{size:s,textColor:o,bold:!0}},{text:"  2496033368@qq.com\n",style:{size:r,textColor:n}},{text:"\n版权所有:",style:{size:s,textColor:o,bold:!0}},{text:"  ©2017-2018 程小刚\n",style:{size:r,textColor:n}}],t}return __extends(t,e),t.prototype.removeThis=function(){this.parent.removeChild(this)},t}(eui.Component);__reflect(AboutView.prototype,"AboutView");var Chess=function(e){function t(t,i,s){var r=e.call(this)||this;r.isSelect=!1,r.chessShape=new egret.Shape,r.chessLabel=new egret.TextField,r.CHESSATTR=s;var o=ChessboardPara.Shared(),n=o.stationW,h=o.stationH;return r.width=n,r.height=h,r.addChild(r.chessShape),r.addChild(r.chessLabel),r.cacheAsBitmap=!0,r.setChessType(t,i),r}return __extends(t,e),t.prototype.setChessType=function(e,t){this.chessType=e,this.chessGroup=t,this.chessAttr=this.CHESSATTR.getChessObjByChess(e),this.refreshChessShape(),this.refreshChessLable()},t.prototype.select=function(e){this.isSelect=e,this.refreshChessShape()},t.prototype.refreshChessShape=function(){var e=ChessboardPara.Shared(),t=e.chessW,i=e.chessH,s=this.chessShape;s.graphics.clear(),this.isSelect?(this.chessAttr.camp==con.camp.blue&&s.graphics.lineStyle(6,16711680),this.chessAttr.camp==con.camp.red&&s.graphics.lineStyle(6,255),this.chessAttr.camp==con.camp.neutral&&s.graphics.lineStyle(6,1432064)):0!==this.chessType?s.graphics.lineStyle(4,11448239):s.graphics.lineStyle(0,16777215),0===this.chessType?s.graphics.beginFill(16777215,0):s.graphics.beginFill(16511676,1),s.graphics.drawRect(0,0,t,i),s.graphics.endFill()},t.prototype.refreshChessLable=function(){var e=ChessboardPara.Shared(),t=e.chessW,i=e.chessH,s=this.chessLabel;this.chessAttr.camp==con.camp.blue&&(s.textColor=202491),this.chessAttr.camp==con.camp.red&&(s.textColor=16450307),s.text=this.chessAttr.description,s.size=28,s.bold=!0,s.width=t,s.height=i,s.fontFamily="Microsoft Yahei",s.textAlign=egret.HorizontalAlign.CENTER,s.verticalAlign=egret.VerticalAlign.MIDDLE},t.prototype.addOrRemoveClickEvent=function(e){e?(this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickChess,this)):(this.touchEnabled=!1,this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickChess,this))
},t.prototype.clickChess=function(e){e.stopPropagation(),e.preventDefault(),this.chessGroup.player.isPlaying&&(this.isSelect?(this.chessGroup.selectChess(this.chessType,!1),this.chessGroup.scene.outSelectChess(this.chessType)):(this.chessGroup.selectChess(this.chessType,!0),this.chessGroup.scene.addSelectChess(this.chessType)))},t.prototype.addLightFilter=function(){var e=6,t=45,i=0,s=.7,r=16,o=16,n=.65,h=1,a=!1,p=!1,u=new egret.DropShadowFilter(e,t,i,s,r,o,n,h,a,p);this.filters=[u]},t}(egret.DisplayObjectContainer);__reflect(Chess.prototype,"Chess");var ChessboardBackground=function(e){function t(){var t=e.call(this)||this;t.roadShp=new egret.Shape,t.stationLabel=null,t.stationShp=new egret.Shape,t.xingyingLabel=null,t.xingyingShp=null,t.renderTexture=new egret.RenderTexture,t.textColor=0,t.fillXingyingColor=12369084,t.fillStationColor=12369084;var i=ChessboardPara.Shared(),s=new eui.Image;return s.width=i.chessboardW,s.height=i.chessboardH,s.top=0,s.bottom=0,s.left=0,s.right=0,s.source="bg_chessboard_png",t.addChild(s),t.addChild(t.roadShp),t.addChild(t.stationShp),t.drawChessboard(),t.cacheAsBitmap=!0,t}return __extends(t,e),t.Shared=function(){return null==t.shared&&(t.shared=new t),t.shared},t.prototype.drawChessboard=function(){this.drawWay(),this.drawAllStationAndXingying()},t.prototype.drawWay=function(){for(var e=[0,1,2,3,4,55,56,57,58,59,0,10,15,20,35,40,45,55,5,9,7,7,15,19,30,34,32,32,40,44],t=[5,26,27,28,9,50,31,32,33,54,4,14,19,24,39,44,49,59,29,25,15,19,27,27,54,50,40,44,52,52],i=[5,50,54,9,25,30,27],s=[50,54,9,5,29,34,32],r=e.length,o=0;r>o;o++)this.drawHighway(e[o],t[o]);r=i.length;for(var o=0;r>o;o++)this.drawRailway(i[o],s[o])},t.prototype.drawHighway=function(e,t){var i=ChessboardPara.Shared(),s=i.getPixelByLocX(e%5),r=i.getPixelByLocY(Math.floor(e/5)),o=i.getPixelByLocX(t%5),n=i.getPixelByLocY(Math.floor(t/5)),h=this.roadShp;h.graphics.lineStyle(2,0),h.graphics.moveTo(s,r),h.graphics.lineTo(o,n),h.graphics.endFill()},t.prototype.drawRailway=function(e,t){for(var i=ChessboardPara.Shared(),s=i.getPixelByLocX(e%5),r=i.getPixelByLocY(Math.floor(e/5)),o=i.getPixelByLocX(t%5),n=i.getPixelByLocY(Math.floor(t/5)),h=i.railwayColorSpace,a=Math.sqrt((o-s)*(o-s)+(n-r)*(n-r)),p=h*(o-s)/a,u=h*(n-r)/a,c=Math.floor(a/h),l=0,g=0,d=0,y=0,b=!0,_=0;c>_;_++){l=s+p*_,g=r+u*_,d=l+p,y=g+u,_==c-1&&(d=o,y=n);var m=this.roadShp;b?m.graphics.lineStyle(12,15386129):m.graphics.lineStyle(12,0),b=!b,m.graphics.moveTo(l,g),m.graphics.lineTo(d,y)}},t.prototype.drawAllStationAndXingying=function(){for(var e=0;60>e;e++)con.positionGraph[e].length<8?this.drawStationByPosition(e):this.drawXingyingByPosition(e)},t.prototype.drawStationByPosition=function(e){var t=con.bigCampPosition,i=ChessboardPara.Shared(),s=i.stationW,r=i.stationH,o=new eui.Group;o.width=s,o.height=r;var n=new egret.Shape;n.graphics.lineStyle(2,0),n.graphics.beginFill(this.fillStationColor,1);var h=e%5,a=Math.floor(e/5),p=i.getPixelByLocX(h),u=i.getPixelByLocY(a);n.graphics.drawRect(0,0,s,r),n.graphics.endFill();var c=new egret.TextField;t.indexOf(e)>-1?c.text="大本营":c.text="兵 站",c.size=20,c.textColor=this.textColor,c.width=s,c.height=r,c.fontFamily="Microsoft Yahei",c.textAlign=egret.HorizontalAlign.CENTER,c.verticalAlign=egret.VerticalAlign.MIDDLE,o.addChild(n),o.addChild(c),o.x=p,o.y=u,o.anchorOffsetX=s/2,o.anchorOffsetY=r/2,this.addChild(o)},t.prototype.drawXingyingByPosition=function(e){var t=ChessboardPara.Shared(),i=t.stationW,s=t.stationH,r=e%5,o=Math.floor(e/5),n=t.getPixelByLocX(r),h=t.getPixelByLocY(o),a=1.2*i,p=1.2*s,u=new eui.Group;u.width=a,u.height=p;var c=new egret.Shape;c.graphics.lineStyle(2,0),c.graphics.beginFill(this.fillXingyingColor,1),c.graphics.drawEllipse(0,0,a,p),c.graphics.endFill();var l=null;l=new egret.TextField,l.text="行 营",l.size=20,l.textColor=this.textColor,l.width=a,l.height=p,l.fontFamily="Microsoft Yahei",l.textAlign=egret.HorizontalAlign.CENTER,l.verticalAlign=egret.VerticalAlign.MIDDLE,u.addChild(c),u.addChild(l),u.x=n,u.y=h,u.anchorOffsetX=a/2,u.anchorOffsetY=p/2,this.addChild(u)},t}(egret.DisplayObjectContainer);__reflect(ChessboardBackground.prototype,"ChessboardBackground");var ChessboardPara=function(){function e(){this.init(720,1200)}return e.Shared=function(){return null==e.shared&&(e.shared=new e),e.shared},e.prototype.init=function(e,t){var i=e/10,s=t/20,r=1.3*i,o=1*s,n=(e-2*i)/4,h=3.5*s,a=e/40,p=(t-2*s-h)/10;this.chessboardW=e,this.chessboardH=t,this.leftOffset=i,this.topOffset=s,this.stationW=r,this.stationH=o,this.chessW=r,this.chessH=o,this.locSpaceX=n,this.hillSpace=h,this.railwayColorSpace=a,this.locSpaceY=p},e.prototype.getPixelByLocX=function(e){return this.locSpaceX*e+this.leftOffset},e.prototype.getPixelByLocY=function(e){return 5>=e?(10-e)*this.locSpaceY+this.topOffset+this.hillSpace:(11-e)*this.locSpaceY+this.topOffset},e.prototype.getLocByPixel=function(e,t,i){var s=0,r=0,s=Math.round((e-this.leftOffset)/this.locSpaceX);r=t>=this.chessboardH/2?10-Math.round((t-this.topOffset-this.hillSpace)/this.locSpaceY):11-Math.round((t-this.topOffset)/this.locSpaceY);var i=i||!0;if(i){var o=this.getPixelByLocX(s),n=this.getPixelByLocY(r);return Math.abs(e-o)<this.stationW/2&&Math.abs(t-n)<this.stationH/2?s+5*r:-1}return s+5*r},e}();__reflect(ChessboardPara.prototype,"ChessboardPara");var ChessGroup=function(e){function t(t,i,s){var r=e.call(this)||this;return r.chessOffset=6,r.loc=-1,r.chessArr=[],r.selectChessArr=[],r.chessShapeArr=[],r.panelChessShapeArr=[],r.selectPanel=null,r.scene=t,r.player=r.scene.mediator.player,r.loc=i,r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,r.touchTap,r),r.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r.touchBegin,r),r.CHESSATTR=s,r}return __extends(t,e),t.prototype.initSelectChessPanel=function(){if(!this.selectPanel){var e=ChessboardPara.Shared(),t=this.loc%5,i=Math.floor(this.loc/5),s=e.chessW,r=e.chessH,o=2.3*s,n=2.6*r;this.selectPanel=new eui.Group;var h=new egret.Shape;h.graphics.lineStyle(2,0),h.graphics.beginFill(16511676,1),h.graphics.drawRect(0,0,o,n),h.graphics.endFill();var a=new eui.Group;a.width=o,a.height=n,this.selectPanelGroup=a,this.selectPanel.addChild(h),this.selectPanel.addChild(a),3>t?this.selectPanel.x=s+10:this.selectPanel.x=-20-o,i>0?this.selectPanel.y=0:this.selectPanel.y=r-n,this.selectPanel.$setVisible(!1),this.addChild(this.selectPanel)}},t.prototype.setChessGroup=function(e){this.chessArr=e,this.selectChessArr=[],this.chessAttr=this.CHESSATTR.getChessObjByChess(this.chessArr),this.initChessGroup()},t.prototype.initChessGroup=function(){var e=ChessboardPara.Shared(),t=e.chessW,i=e.chessH;this.width=t,this.height=i,this.x=e.getPixelByLocX(this.loc%5),this.y=e.getPixelByLocY(Math.floor(this.loc/5)),this.anchorOffsetX=t/2,this.anchorOffsetY=i/2;var s=this.chessArr.length,r=(this.selectChessArr,this);this.chessShapeArr.forEach(function(e,t,i){r.removeChild(e)}),this.chessShapeArr=[],this.panelChessShapeArr=[];for(var o=0;s>o;o++){this.chessArr[o]===con.chessType.kong;var n=new Chess(this.chessArr[o],this,this.CHESSATTR);if(this.chessShapeArr.push(n),this.addChild(n),this.chessAttr.moveType==con.moveType.unable||this.chessAttr.camp!=n.chessAttr.camp){var h=new Chess(this.chessArr[o],this,this.CHESSATTR);this.panelChessShapeArr.push(h)}}this.refreshChessGroup()},t.prototype.refreshChessGroup=function(){var e=ChessboardPara.Shared(),t=this;this.chessShapeArr.forEach(function(e,i){t.isSelectedChess(e.chessType)?e.select(!0):e.select(!1),e.x=-t.chessOffset*i,e.y=-t.chessOffset*i});var i=e.stationW,s=e.stationH,r=.1*i,o=.2*s,n=0,h=0;this.panelChessShapeArr.forEach(function(e,a){t.isSelectedChess(e.chessType)?e.select(!0):e.select(!1),n=Math.floor(a/2),h=a%2,e.x=i*h+r+r*h,e.y=s*n+o+o*n})},t.prototype.touchTap=function(e){e.stopPropagation(),e.preventDefault(),this.acquireFocus(),this.selectPanelGroup!==e.target&&this.scene.clickChessGroup(this)},t.prototype.touchBegin=function(e){e.preventDefault(),e.stopPropagation(),this.touchMoveStartX=e.stageX,this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},t.prototype.touchEnd=function(e){e.preventDefault(),e.stopPropagation(),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this)},t.prototype.touchMove=function(e){e.preventDefault(),e.stopPropagation();var t=ChessboardPara.Shared();Math.abs(e.stageX-this.touchMoveStartX)>t.stationW/3&&(this.showOrHideSelectpanel(),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this))},t.prototype.showOrHideSelectpanel=function(){if(this.initSelectChessPanel(),this.selectPanel.visible)return void this.selectPanel.$setVisible(!1);if(!(this.chessArr.length<2)){this.acquireFocus();var e=!1;this.player.isPlaying&&this.chessAttr.camp==this.player.camp&&con.positionGraph[this.loc].length<8&&(e=!0);var t=this;this.selectPanelGroup.removeChildren(),this.panelChessShapeArr.forEach(function(i,s){t.selectPanelGroup.addChild(i),i.addOrRemoveClickEvent(e)}),this.selectPanel.$setVisible(!0)}},t.prototype.getMainChessType=function(){for(var e=this.chessShapeArr.length,t=null,i=null,s=0;e>s;s++)t=this.chessShapeArr[s],this.chessAttr.moveType!=con.moveType.unable&&this.chessAttr.camp==t.chessAttr.camp&&(i=this.chessArr[s]);return i},t.prototype.selectChessGroup=function(e){e?this.selectChessArr=Util.clone(this.chessArr):this.selectChessArr=[],this.refreshChessGroup()},t.prototype.setSelectChessArr=function(e){this.selectChessArr=Util.clone(e);var t=this.getMainChessType();t&&(this.isSelectedChess(t)||this.selectChessArr.push(t)),this.refreshChessGroup()},t.prototype.selectChess=function(e,t){if(t){this.isSelectedChess(e)||this.selectChessArr.push(e);var i=this.getMainChessType();i&&(this.isSelectedChess(i)||this.selectChessArr.push(i))}else{var s=this.selectChessArr.indexOf(e);s>-1&&this.selectChessArr.splice(s,1)}this.refreshChessGroup()},t.prototype.isSelectedChess=function(e){var t=!1;return this.selectChessArr&&this.selectChessArr.indexOf(e)>-1&&(t=!0),t},t.prototype.acquireFocus=function(){this.parent.setChildIndex(this,this.parent.numChildren-1)},t.prototype.hideSelecChessPanel=function(){this.initSelectChessPanel(),this.selectPanel.$setVisible(!1)},t.prototype.moveChess=function(e,t,i,s){function r(e){e.preventDefault(),e.stopPropagation();for(var i=new Date,a=i.getTime()-h.getTime(),y=_*(1-Math.cos(m*a)),f=0,v=0;p>v;v++)if(p>v+1&&(u=o.getPixelByLocX(t[v]%5),c=o.getPixelByLocY(Math.floor(t[v]/5)),l=o.getPixelByLocX(t[v+1]%5),g=o.getPixelByLocY(Math.floor(t[v+1]/5)),d=Math.sqrt((l-u)*(l-u)+(g-c)*(g-c)),f+=d,f>y)){f-=d;var L=(y-f)*(l-u)/d,P=(y-f)*(g-c)/d;Math.abs(L)<.1&&(L=0),Math.abs(P)<.1&&(P=0),n.chessShapeArr.forEach(function(e,t){n.isSelectedChess(e.chessType)&&(e.x=u+L-n.x-4*t,e.y=c+P-n.y-4*t)});break}a>=b&&(n.removeEventListener(egret.Event.ENTER_FRAME,r,n),s&&"function"==typeof s&&s(),n.stage.frameRate=30)}this.stage.frameRate=60,this.setSelectChessArr(i),this.acquireFocus();for(var o=ChessboardPara.Shared(),n=this,h=new Date,a=0,p=t.length,u=0,c=0,l=0,g=0,d=0,y=0;p>y;y++)p>y+1&&(u=o.getPixelByLocX(t[y]%5),c=o.getPixelByLocY(Math.floor(t[y]/5)),l=o.getPixelByLocX(t[y+1]%5),g=o.getPixelByLocY(Math.floor(t[y+1]/5)),d=Math.sqrt((l-u)*(l-u)+(g-c)*(g-c)),a+=d);var b=600+50*p,_=a/2,m=Math.PI/b;this.addEventListener(egret.Event.ENTER_FRAME,r,this)},t.prototype.overChess=function(e,t){this.stage.frameRate=60,this.selectChessGroup(!0),this.acquireFocus();var i=ChessboardPara.Shared(),s=i.chessW,r=this,o=(new Date,this.chessShapeArr[0]);o.select(!1),o.anchorOffsetX;var n=egret.Tween.get(o);n.to({scaleX:.1,anchorOffsetX:-s},400).call(function(){o.setChessType(e,r)}).to({scaleX:1,anchorOffsetX:0},400).call(function(){t&&"function"==typeof t&&t(),r.stage.frameRate=30})},t}(egret.DisplayObjectContainer);__reflect(ChessGroup.prototype,"ChessGroup");var Dialog=function(e){function t(){var t=e.call(this)||this;return t.skinName="src/game/scenes/common/DialogSkin.exml",t}return __extends(t,e),t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.onclick_confirm=function(){},t.prototype.onclick_cancel=function(){this.removeThis()},t}(eui.Panel);__reflect(Dialog.prototype,"Dialog");var MenuButton=function(e){function t(t,i,s){var r=e.call(this)||this,o='<?xml version="1.0" encoding="utf-8" ?>\n                    <e:Skin class="MenuButtonSkin" states="up,down,disabled" xmlns:e="http://ns.egret.com/eui">\n                        <e:Image id="img_btn" top="5" width="100" height="100" scale9Grid="1,3,8,8" horizontalCenter="0"\n                                alpha.disabled="0.5" source="'+t+'" alpha.down="0.8" source.down="'+i+'"/>\n                        <e:Label id="label_text" bottom="0" height="30" horizontalCenter="0" fontFamily="Microsoft Yahei"\n                                textColor="0xF9B683" size="32" text="'+s+'" />\n                    </e:Skin>';return r.skinName=o,r.width=150,r.height=150,r}return __extends(t,e),t}(eui.Button);__reflect(MenuButton.prototype,"MenuButton");var PlayerInfoView=function(e){function t(){var t=e.call(this)||this;t.skinName="src/game/scenes/common/PlayerInfoViewSkin.exml";var i=ChessboardPara.Shared();return t.width=i.chessboardW,t.height=i.chessboardH,t.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,t.removeThis,t),t}return __extends(t,e),t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.setPlayerInfo=function(e){if(e){var t=e.userInfo;t&&(this.label_username.text=e.name,this.label_count.text="胜利: "+t.winCount+" 失败:"+t.loseCount+" 平局:"+t.drawCount,this.label_victoryRate.text=e.getVictoryRateStr(),this.label_escape_count.text=t.escapeCount,this.label_beans.text=t.beans,this.label_grade.text=t.score,this.label_honor.text=t.score)}},t}(eui.Component);__reflect(PlayerInfoView.prototype,"PlayerInfoView");var WaitView=function(e){function t(){var t=e.call(this)||this;t.skinName='<?xml version="1.0" encoding="utf-8"?>\n                            <e:Skin class="WaitViewSkin" width="720" height="1200" xmlns:e="http://ns.egret.com/eui"\n                                    xmlns:w="http://ns.egret.com/wing">\n                                <e:Rect id="rect_mask" right="0" top="0" bottom="0" left="0" fillAlpha="0.1" locked="true" />\n                                <e:Group horizontalCenter="0" width="60" height="60" verticalCenter="0">\n                                    <e:Rect id="rect_wait_1" width="10" height="50" fillAlpha="0.8"   fillColor="0xffa76b"/>\n                                    <e:Rect id="rect_wait_2" width="10" height="50" fillAlpha="0.8"  fillColor="0xffa76b"/>\n                                    <e:Rect id="rect_wait_3" width="10" height="50" fillAlpha="0.8"  fillColor="0xffa76b"/>\n                                    <e:Rect id="rect_wait_4" width="10" height="50" fillAlpha="0.8"  fillColor="0xffa76b"/>\n                                        <e:layout>\n                                            <e:HorizontalLayout horizontalAlign="center" verticalAlign="middle"/>\n                                        </e:layout>\n                                </e:Group>\n                            </e:Skin>';var i=ChessboardPara.Shared();return t.width=i.chessboardW,t.height=i.chessboardH,t.setAnimation(),t}return __extends(t,e),t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.setAnimation=function(){var e=egret.Tween.get(this.rect_wait_1,{loop:!0});e.wait(100).to({scaleY:.2},500).to({scaleY:1},500);var t=egret.Tween.get(this.rect_wait_2,{loop:!0});t.wait(200).to({scaleY:.2},500).to({scaleY:1},500);var i=egret.Tween.get(this.rect_wait_3,{loop:!0});i.wait(300).to({scaleY:.2},500).to({scaleY:1},500);var s=egret.Tween.get(this.rect_wait_4,{loop:!0});s.wait(400).to({scaleY:.2},500).to({scaleY:1},500)},t}(eui.Component);__reflect(WaitView.prototype,"WaitView");var con;!function(e){function t(e){return e!=r.neutral?e==r.blue?r.red:r.blue:r.neutral}function i(t,i){var s=e.positionGraph[t],r=s.indexOf(i);return-1!=r?!0:!1}function s(e,t){for(var i=e.kills,s=i.length,r=0;s>r;r++)if(i[r][0]===t.type)return!0;return!1}var r;!function(e){e[e.blue=1]="blue",e[e.red=2]="red",e[e.neutral=3]="neutral"}(r=e.camp||(e.camp={}));var o;!function(e){e[e.unable=0]="unable",e[e.oneStep=1]="oneStep",e[e.line=2]="line",e[e.curve=3]="curve"}(o=e.moveType||(e.moveType={}));var n=function(){function e(){this.isGroup=!1,this.description="",this.kills=[]}return e}();e.ChessAttr=n,__reflect(n.prototype,"con.ChessAttr");var h;!function(e){e[e.conn=1]="conn",e[e.login=2]="login",e[e.disconnect=3]="disconnect",e[e.logout=4]="logout"}(h=e.loginStatus||(e.loginStatus={}));var a;!function(e){e[e.login=1]="login",e[e.visitor=5]="visitor",e[e.player1=2]="player1",e[e.player2=3]="player2",e[e.player=6]="player",e[e.looker=4]="looker"}(a=e.playerRole||(e.playerRole={}));var p;!function(e){e[e.distribute=5]="distribute",e[e.undistributed=6]="undistributed",e[e.ready=7]="ready",e[e.notReady=8]="notReady",e[e.start=9]="start",e[e.end=10]="end"}(p=e.playerStatus||(e.playerStatus={}));var u;!function(e){e[e.waitplayer=1]="waitplayer",e[e.gamestart=2]="gamestart"}(u=e.roomStatus||(e.roomStatus={}));var c;!function(e){e[e.playing=1]="playing",e[e.lose=2]="lose",e[e.win=3]="win",e[e.draw=4]="draw",e[e.redwin=5]="redwin",e[e.bluewin=6]="bluewin"}(c=e.victoryStatus||(e.victoryStatus={})),e.positionGraph=new Array(60),e.positionGraph[0]=[5,1],e.positionGraph[1]=[6,2,0],e.positionGraph[2]=[7,3,1],e.positionGraph[3]=[8,4,2],e.positionGraph[4]=[9,3],e.positionGraph[5]=[10,11,6,0],e.positionGraph[6]=[11,7,1,5],e.positionGraph[7]=[12,13,8,2,6,11],e.positionGraph[8]=[13,9,3,7],e.positionGraph[9]=[14,4,8,13],e.positionGraph[10]=[15,11,5],e.positionGraph[11]=[16,17,12,7,6,5,10,15],e.positionGraph[12]=[17,13,7,11],e.positionGraph[13]=[18,19,14,9,8,7,12,17],e.positionGraph[14]=[19,9,13],e.positionGraph[15]=[20,21,16,11,10],e.positionGraph[16]=[21,17,11,15],e.positionGraph[17]=[22,23,18,13,12,11,16,21],e.positionGraph[18]=[23,19,13,17],e.positionGraph[19]=[24,14,13,18,23],e.positionGraph[20]=[25,21,15],e.positionGraph[21]=[26,27,22,17,16,15,20,25],e.positionGraph[22]=[27,23,17,21],e.positionGraph[23]=[28,29,24,19,18,17,22,27],e.positionGraph[24]=[29,19,23],e.positionGraph[25]=[30,26,21,20],e.positionGraph[26]=[27,21,25],e.positionGraph[27]=[32,28,23,22,21,26],e.positionGraph[28]=[29,23,27],e.positionGraph[29]=[34,24,23,28],e.positionGraph[30]=[35,36,31,25],e.positionGraph[31]=[36,32,30],e.positionGraph[32]=[37,38,33,27,31,36],e.positionGraph[33]=[38,34,32],e.positionGraph[34]=[39,29,33,38],e.positionGraph[35]=[40,36,30],e.positionGraph[36]=[41,42,37,32,31,30,35,40],e.positionGraph[37]=[42,38,32,36],e.positionGraph[38]=[43,44,39,34,33,32,37,42],e.positionGraph[39]=[44,34,38],e.positionGraph[40]=[45,46,41,36,35],e.positionGraph[41]=[46,42,36,40],e.positionGraph[42]=[47,48,43,38,37,36,41,46],e.positionGraph[43]=[48,44,38,42],e.positionGraph[44]=[49,39,38,43,48],e.positionGraph[45]=[50,46,40],e.positionGraph[46]=[51,52,47,42,41,40,45,50],e.positionGraph[47]=[52,48,42,46],e.positionGraph[48]=[53,54,49,44,43,42,47,52],e.positionGraph[49]=[54,44,48],e.positionGraph[50]=[55,51,46,45],e.positionGraph[51]=[56,52,46,50],e.positionGraph[52]=[57,53,48,47,46,51],e.positionGraph[53]=[58,54,48,52],e.positionGraph[54]=[59,49,48,53],e.positionGraph[55]=[56,50],e.positionGraph[56]=[57,51,55],e.positionGraph[57]=[58,52,56],e.positionGraph[58]=[59,53,57],e.positionGraph[59]=[54,58],e.xingyingPosition=[11,13,17,21,23,36,38,42,46,48],e.bigCampPosition=[1,3,56,58];var l;!function(e){e[e.kong=0]="kong",e[e.cover=500]="cover",e[e.bLeader=49]="bLeader",e[e.bJun=50]="bJun",e[e.bShi=26]="bShi",e[e.bLv=28]="bLv",e[e.bTuan=30]="bTuan",e[e.bYing=32]="bYing",e[e.bLian=23]="bLian",e[e.bPai=20]="bPai",e[e.bGong=51]="bGong",e[e.bZha=54]="bZha",e[e.bLei=67]="bLei",e[e.bQi=59]="bQi",e[e.rLeader=65]="rLeader",e[e.rJun=66]="rJun",e[e.rShi=40]="rShi",e[e.rLv=42]="rLv",e[e.rTuan=44]="rTuan",e[e.rYing=46]="rYing",e[e.rLian=34]="rLian",e[e.rPai=37]="rPai",e[e.rGong=62]="rGong",e[e.rZha=60]="rZha",e[e.rLei=56]="rLei",e[e.rQi=48]="rQi",e[e.bPai_rZha=80]="bPai_rZha",e[e.rPai_bZha=91]="rPai_bZha",e[e.bPai_rZha2=141]="bPai_rZha2",e[e.rPai_bZha2=146]="rPai_bZha2",e[e.bGong_rQi=99]="bGong_rQi",e[e.rQi_rLei=104]="rQi_rLei",e[e.bGong_rLei=107]="bGong_rLei",e[e.rLei2=113]="rLei2",e[e.bGong_rQi_rLei=155]="bGong_rQi_rLei",e[e.rQi_rLei2=161]="rQi_rLei2",e[e.bGong_rLei2=164]="bGong_rLei2",e[e.rLei3=171]="rLei3",e[e.bGong_rQi_rLei2=212]="bGong_rQi_rLei2",e[e.rQi_rLei3=219]="rQi_rLei3",e[e.bGong_rLei3=222]="bGong_rLei3",e[e.bGong_rQi_rLei3=270]="bGong_rQi_rLei3",e[e.rGong_bQi=121]="rGong_bQi",e[e.bQi_bLei=126]="bQi_bLei",e[e.rGong_bLei=129]="rGong_bLei",e[e.bLei2=135]="bLei2",e[e.rGong_bQi_bLei=188]="rGong_bQi_bLei",e[e.bQi_bLei2=194]="bQi_bLei2",e[e.rGong_bLei2=197]="rGong_bLei2",e[e.bLei3=204]="bLei3",e[e.rGong_bQi_bLei2=256]="rGong_bQi_bLei2",e[e.bQi_bLei3=263]="bQi_bLei3",e[e.rGong_bLei3=266]="rGong_bLei3",e[e.rGong_bQi_bLei3=325]="rGong_bQi_bLei3"}(l=e.chessType||(e.chessType={})),e.chessCtMap={0:l.kong,500:l.cover,20:l.bPai,21:l.bPai,22:l.bPai,23:l.bLian,24:l.bLian,25:l.bLian,26:l.bShi,27:l.bShi,28:l.bLv,29:l.bLv,30:l.bTuan,31:l.bTuan,32:l.bYing,33:l.bYing,34:l.rLian,35:l.rLian,36:l.rLian,37:l.rPai,38:l.rPai,39:l.rPai,40:l.rShi,41:l.rShi,42:l.rLv,43:l.rLv,44:l.rTuan,45:l.rTuan,46:l.rYing,47:l.rYing,48:l.rQi,49:l.bLeader,50:l.bJun,51:l.bGong,52:l.bGong,53:l.bGong,54:l.bZha,55:l.bZha,56:l.rLei,57:l.rLei,58:l.rLei,59:l.bQi,60:l.rZha,61:l.rZha,62:l.rGong,63:l.rGong,64:l.rGong,65:l.rLeader,66:l.rJun,67:l.bLei,68:l.bLei,69:l.bLei,99:l.bGong_rQi,100:l.bGong_rQi,101:l.bGong_rQi,104:l.rQi_rLei,105:l.rQi_rLei,106:l.rQi_rLei,107:l.bGong_rLei,108:l.bGong_rLei,109:l.bGong_rLei,110:l.bGong_rLei,111:l.bGong_rLei,113:l.rLei2,114:l.rLei2,115:l.rLei2,121:l.rGong_bQi,122:l.rGong_bQi,123:l.rGong_bQi,126:l.bQi_bLei,127:l.bQi_bLei,128:l.bQi_bLei,129:l.rGong_bLei,130:l.rGong_bLei,131:l.rGong_bLei,132:l.rGong_bLei,133:l.rGong_bLei,135:l.bLei2,136:l.bLei2,137:l.bLei2,155:l.bGong_rQi_rLei,156:l.bGong_rQi_rLei,157:l.bGong_rQi_rLei,158:l.bGong_rQi_rLei,159:l.bGong_rQi_rLei,161:l.rQi_rLei2,162:l.rQi_rLei2,163:l.rQi_rLei2,164:l.bGong_rLei2,165:l.bGong_rLei2,166:l.bGong_rLei2,167:l.bGong_rLei2,168:l.bGong_rLei2,171:l.rLei3,188:l.rGong_bQi_bLei,189:l.rGong_bQi_bLei,190:l.rGong_bQi_bLei,191:l.rGong_bQi_bLei,192:l.rGong_bQi_bLei,194:l.bQi_bLei2,195:l.bQi_bLei2,196:l.bQi_bLei2,197:l.rGong_bLei2,198:l.rGong_bLei2,199:l.rGong_bLei2,200:l.rGong_bLei2,201:l.rGong_bLei2,204:l.bLei3,212:l.bGong_rQi_rLei2,213:l.bGong_rQi_rLei2,214:l.bGong_rQi_rLei2,215:l.bGong_rQi_rLei2,216:l.bGong_rQi_rLei2,219:l.rQi_rLei3,222:l.bGong_rLei3,223:l.bGong_rLei3,224:l.bGong_rLei3,256:l.rGong_bQi_bLei2,257:l.rGong_bQi_bLei2,258:l.rGong_bQi_bLei2,259:l.rGong_bQi_bLei2,260:l.rGong_bQi_bLei2,263:l.bQi_bLei3,266:l.rGong_bLei3,267:l.rGong_bLei3,268:l.rGong_bLei3,270:l.bGong_rQi_rLei3,271:l.bGong_rQi_rLei3,272:l.bGong_rQi_rLei3,325:l.rGong_bQi_bLei3,326:l.rGong_bQi_bLei3,327:l.rGong_bQi_bLei3,80:l.bPai_rZha,81:l.bPai_rZha,82:l.bPai_rZha,83:l.bPai_rZha,91:l.rPai_bZha,92:l.rPai_bZha,93:l.rPai_bZha,94:l.rPai_bZha,141:l.bPai_rZha2,142:l.bPai_rZha2,143:l.bPai_rZha2,146:l.rPai_bZha2,147:l.rPai_bZha2,148:l.rPai_bZha2},e.getOppositeCamp=t,e.isNextPosition=i,e.isKillChessObj=s}(con||(con={}));var SceneNetWorking=function(e){function t(i){var s=e.call(this)||this;s.chessGroupArr=[],s.mediator=null,s.mediator=i,t.shared=s,s.skinName="src/game/scenes/networking/SceneNetWorkingSkin.exml";var r=ChessboardPara.Shared();return s.width=r.chessboardW,s.height=r.chessboardH,s.init(),s}return __extends(t,e),t.prototype.init=function(){ChessboardPara.Shared();this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_back,this),this.btn_menu.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_menu,this);var e=new ChessboardBackground;this.group_background.addChild(e),this.label_toast.$setVisible(!1),this.secondPage=new NetSecondPage(this)},t.prototype.setMsg=function(e,t){this.label_msg.$setTextColor(e),this.label_msg.text=t},t.prototype.refreshMsg=function(){var e=this.mediator.room,t="",i=0;if(e&&e.roomStatus===con.roomStatus.gamestart){var s=e.getHostPlayer();if(s)switch(t=s.name+"  "+e.hostPlayerTimeCount,s.camp){case con.camp.red:i=16711680;break;case con.camp.blue:i=255;break;case con.camp.neutral:i=0}}this.label_msg.text=t,this.label_msg.textColor=i},t.prototype.setToastMsg=function(e){var t=this;this.label_toast.text=e,this.label_toast.$setVisible(!0),setTimeout(function(){t.label_toast.text="",t.label_toast.$setVisible(!1)},5e3)},t.prototype.suePeaceRet=function(e){e?this.secondPage.popSuePeaceDialog(1):this.setToastMsg("对方拒绝和棋!")},t.prototype.clearMsg=function(){this.label_msg.text=""},t.prototype.onclick_menu=function(){this.secondPage.popMenuView()},t.prototype.onclick_back=function(){var e=this.mediator.room;return e&&e.roomStatus===con.roomStatus.gamestart?void this.setToastMsg("您当前游戏进行中,不能退出!"):(this.mediator.loginOut(),this.parent.addChild(SceneIndex.Shared()),void this.parent.removeChild(this))},t.prototype.initChessboardView=function(){var e=this.mediator.room;if(e){this.group_chessGroup.removeChildren(),this.chessGroupArr=[];var t=this.mediator.chessAttr;if(e)for(var i=e.chessboard,s=null,r=0;60>r;r++)s=new ChessGroup(this,r,t),s.setChessGroup(i[r]),this.chessGroupArr.push(s),this.group_chessGroup.addChild(s)}},t.prototype.getChessGroupByLoc=function(e){return this.chessGroupArr?this.chessGroupArr[e]:null},t.prototype.cancleAllSelectChessGroup=function(){var e=this.mediator.player;e.cancleAllSelectChess(),this.chessGroupArr.forEach(function(e){e.selectChessGroup(!1)})},t.prototype.addSelectChess=function(e){var t=this.mediator.player;t.addSelectChess(e)},t.prototype.outSelectChess=function(e){var t=this.mediator.player;t.outSelectChess(e)},t.prototype.hideAllChessGroupSelectChessPanel=function(){this.chessGroupArr.forEach(function(e){e.hideSelecChessPanel()})},t.prototype.clickChessGroup=function(e){this.mediator.clickChessGroup(e)},t.prototype.login=function(e,t){this.mediator.login(e,t)},t.prototype.loginRet=function(e){this.secondPage.loginView.loginRet(e)},t.prototype.reLoginRet=function(){this.secondPage.popLoginView()},t.prototype.register=function(e){this.mediator.register(e)},t.prototype.enterRoom=function(e){this.mediator.enterRoom(e)},t.prototype.enterRoomRet=function(){this.secondPage.hideAllSecondPage(),this.secondPage.popRoomView()},t.prototype.ready=function(){this.mediator.ready()},t.prototype.readyRet=function(){this.secondPage.popRoomView()},t.prototype.changeRoom=function(){this.mediator.changeRoom()},t.prototype.leaveRoom=function(){var e=this.mediator.room;e?this.mediator.leaveRoom():(this.secondPage.hideAllSecondPage(),this.secondPage.popNetIndexView())},t.prototype.leaveRoomRet=function(e){var t=this.mediator.room;e?(this.secondPage.hideAllSecondPage(),this.secondPage.popNetIndexView()):t||(this.secondPage.hideAllSecondPage(),this.secondPage.popNetIndexView())},t.prototype.startGameRet=function(){this.secondPage.hideAllSecondPage(),this.initChessboardView(),this.clearMsg()},t.prototype.overChessRet=function(e){var t=this,i=this.chessGroupArr[e.loc];i.overChess(e.chess,function(){t.cancleAllSelectChessGroup(),i.setChessGroup([e.chess]),i.selectChessGroup(!0)})},t.prototype.moveChessRet=function(e){function t(){i.setChessGroup(e.sourceArr),i.selectChessGroup(!0),s.setChessGroup(e.targetArr),s.selectChessGroup(!0)}var i=this.chessGroupArr[e.souLoc],s=this.chessGroupArr[e.tarLoc];i.moveChess(e.tarLoc,e.path,e.selectArr,t)},t.prototype.gameOverRet=function(){this.secondPage.popGameOverView()},t.prototype.chatRet=function(e){this.setToastMsg(e.chatMsg),this.secondPage.chatView&&this.secondPage.chatView.setPlayerChatMsg()},t.prototype.refreshRoomInfo=function(){this.secondPage.roomView&&this.secondPage.roomView.refreshRoomInfo()},t.prototype.disconnect=function(){this.secondPage.hideAllSecondPage(),this.secondPage.popLoginView()},t}(eui.Component);__reflect(SceneNetWorking.prototype,"SceneNetWorking");var EditPlayerInfoView=function(e){function t(t){var i=e.call(this)||this;i.outTimeId=0,i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/EditPlayerInfoViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.btn_edit.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_edit,i),i.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.init(),i}return __extends(t,e),t.prototype.init=function(){var e=this.secondPage.scene.mediator.player,t=e.name,i=e.loginUser.email;this.edit_username.text=t,this.edit_email.text=i,this.removeWaitView(),this.clearTimeOut(),this.setHintMsg("")},t.prototype.onclick_edit=function(){var e=this.edit_username.text,t=this.edit_email.text,i="";if(e?e.length>12&&(i+="用户名不能超过12个字符!"):i+="请填写用户名!",t){var s=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;s.test(t)||(i+="无效的E-mail地址！")}if(i)return void this.setHintMsg(i);var r={username:e,email:t};this.addWaitView();var o=this;this.outTimeId=setTimeout(function(){o.removeWaitView(),o.setHintMsg("请求超时!")},3e4),this.secondPage.scene.mediator.serverIO.editPlayerInfo(r,function(e){o.editRet(e)})},t.prototype.editRet=function(e){e&&(this.removeWaitView(),e.success?this.setHintMsg("修改成功!"):this.setHintMsg("修改失败!"+e.error))},t.prototype.addWaitView=function(){this.waitView||(this.waitView=new WaitView),this.addChild(this.waitView)},t.prototype.removeWaitView=function(){this.waitView&&(this.removeChild(this.waitView),this.waitView=null,this.clearTimeOut())},t.prototype.clearTimeOut=function(){this.outTimeId&&(clearTimeout(this.outTimeId),this.outTimeId=0)},t.prototype.setHintMsg=function(e){this.label_msg.text=e},t.prototype.removeThis=function(){this.removeWaitView(),this.clearTimeOut(),this.parent.removeChild(this)},t}(eui.Component);__reflect(EditPlayerInfoView.prototype,"EditPlayerInfoView");var FindPwdView=function(e){function t(t){var i=e.call(this)||this;i.outTimeId=0,i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/FindPwdViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.btn_find_pwd.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_findPwd,i),i.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.init(),i}return __extends(t,e),t.prototype.init=function(){this.removeWaitView(),this.clearTimeOut(),this.setHintMsg("")},t.prototype.onclick_findPwd=function(){var e=this.edit_email.text,t="";if(e){var i=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;
i.test(e)||(t+="无效的E-mail地址！")}else t+="请填写注册邮箱!";if(t)return void this.setHintMsg(t);this.addWaitView();var s=this;this.outTimeId=setTimeout(function(){s.removeWaitView(),s.setHintMsg("请求超时!")},3e4),this.secondPage.scene.mediator.findBackPwd({email:e})},t.prototype.findPwdRet=function(e){e&&(this.removeWaitView(),e.success?this.setHintMsg("请登录您的邮箱找回密码!"):this.setHintMsg(e.error))},t.prototype.addWaitView=function(){this.waitView||(this.waitView=new WaitView),this.addChild(this.waitView)},t.prototype.removeWaitView=function(){this.waitView&&(this.removeChild(this.waitView),this.waitView=null,this.clearTimeOut())},t.prototype.clearTimeOut=function(){this.outTimeId&&(clearTimeout(this.outTimeId),this.outTimeId=0)},t.prototype.setHintMsg=function(e){this.label_msg.text=e},t.prototype.removeThis=function(){this.removeWaitView(),this.clearTimeOut(),this.parent.removeChild(this)},t}(eui.Component);__reflect(FindPwdView.prototype,"FindPwdView");var GiveUpDialog=function(e){function t(t){var i=e.call(this)||this;return i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/GiveUpDialogSkin.exml",i.btn_giveUp.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_giveUp,i),i}return __extends(t,e),t.prototype.onclick_giveUp=function(){this.secondPage.scene.mediator.giveUp()},t}(eui.Panel);__reflect(GiveUpDialog.prototype,"GiveUpDialog");var NetChatView=function(e){function t(t){var i=e.call(this)||this;i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/NetChatViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.btn_send.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_send,i),i.setPlayerChatMsg(),i}return __extends(t,e),t.prototype.onclick_send=function(){var e=this.edit_msg.text;this.secondPage.scene.mediator.chat(e)},t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.setPlayerChatMsg=function(){var e=this.secondPage.scene.mediator.room,t=this.secondPage.scene.mediator.player.name;this.group_chatHistory.removeChildren();var i=this;if(e){var s=e.playerChatMsgArr;s.forEach(function(e){e&&(e.playerName==t?i.addChatMsg(!0,e.chatMsg):i.addChatMsg(!1,e.chatMsg))})}},t.prototype.addChatMsg=function(e,t){var i=new eui.Group;i.percentWidth=98;var s=new eui.Label;s.maxWidth=500,s.verticalAlign="middle",s.background=!0,s.minHeight=60,s.multiline=!0,s.text=t,e?(s.textAlign="right",s.borderColor=16383,s.textColor=16777215,s.backgroundColor=3571967,s.right=10):(s.textAlign="left",s.borderColor=16383,s.textColor=0,s.backgroundColor=16769248,s.left=10),i.addChild(s),this.group_chatHistory.addChild(i)},t.prototype.testMsg=function(e){e.push({playerName:"qwe",chatMsg:"hello"}),e.push({playerName:"asd",chatMsg:"hello"}),e.push({playerName:"qwe",chatMsg:"playerChatMsgArr"}),e.push({playerName:"asd",chatMsg:"playerChatMsgArr"}),e.push({playerName:"qwe",chatMsg:"playerName"}),e.push({playerName:"asd",chatMsg:"helloplayerName"}),e.push({playerName:"qwe",chatMsg:"hello"}),e.push({playerName:"asd",chatMsg:"hello"}),e.push({playerName:"qwe",chatMsg:"hello"}),e.push({playerName:"asd",chatMsg:"playerChatMsgArr"}),e.push({playerName:"asd",chatMsg:"playerChatMsgArr"})},t}(eui.Component);__reflect(NetChatView.prototype,"NetChatView");var NetIndexView=function(e){function t(t){var i=e.call(this)||this;i.serverPlayerNum=0,i.timeId=0,i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/NetIndexViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.btn_newPeople.addEventListener(egret.TouchEvent.TOUCH_TAP,i.enterLevel1,i),i.refreshLabel(),i}return __extends(t,e),t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.enterLevel1=function(){SceneNetWorking.shared.enterRoom(1)},t.prototype.enterLevel2=function(){SceneNetWorking.shared.enterRoom(2)},t.prototype.refreshLabel=function(){this.label_peopleNum.text="在线人数: "+this.serverPlayerNum+" 人"},t.prototype.getPlayerNum=function(){var e=this;this.secondPage.scene.mediator.serverIO.playerNum(null,function(t){e&&t&&(e.serverPlayerNum=t.num,e.refreshLabel())})},t.prototype.clearTimeId=function(){this.timeId&&(clearTimeout(this.timeId),this.timeId=0)},t}(eui.Component);__reflect(NetIndexView.prototype,"NetIndexView");var NetLoginView=function(e){function t(t){var i=e.call(this)||this;i.loginOutTimeId=0,i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/NetLoginViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.btn_login.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_login,i),i.btn_forget.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_forgetPwd,i),i.btn_register.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_register,i),i.init(),i}return __extends(t,e),t.prototype.init=function(){var e=egret.localStorage.getItem("userName"),t=egret.localStorage.getItem("pwd");e&&(this.edit_userName.text=e,this.edit_userPwd.text=t),this.removeWaitView(),this.clearLoginTimeOut(),this.setLoginMsg("")},t.prototype.onclick_login=function(){var e=this.edit_userName.text,t=this.edit_userPwd.text,i="";if(e||(i+="请填写用户名!"),t||(i+="请填写密码!"),i)return void this.setLoginMsg(i);this.addWaitView();var s=this;this.loginOutTimeId=setTimeout(function(){s.removeWaitView(),s.setLoginMsg("请求超时!")},3e4),this.secondPage.scene.mediator.login(e,t)},t.prototype.loginRet=function(e){if(e)if(this.removeWaitView(),e.success){var t=this.edit_userName.text,i=this.edit_userPwd.text;egret.localStorage.setItem("userName",t),egret.localStorage.setItem("pwd",i),this.setLoginMsg("登录成功!"),this.removeThis(),this.secondPage.popNetIndexView()}else this.setLoginMsg(e.error)},t.prototype.addWaitView=function(){this.waitView||(this.waitView=new WaitView),this.addChild(this.waitView)},t.prototype.removeWaitView=function(){this.waitView&&(this.removeChild(this.waitView),this.waitView=null,this.clearLoginTimeOut())},t.prototype.clearLoginTimeOut=function(){this.loginOutTimeId&&(clearTimeout(this.loginOutTimeId),this.loginOutTimeId=0)},t.prototype.setLoginMsg=function(e){this.label_login_msg.text=e},t.prototype.onclick_forgetPwd=function(){this.secondPage.popFindPwdView()},t.prototype.onclick_register=function(){this.removeThis(),this.secondPage.popRegisterView()},t.prototype.removeThis=function(){this.removeWaitView(),this.clearLoginTimeOut(),this.parent.removeChild(this)},t}(eui.Component);__reflect(NetLoginView.prototype,"NetLoginView");var NetMenuView=function(e){function t(t){var i=e.call(this)||this;i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/NetMenuViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.createMenuButton(),i.addButtonClickEvent(),i}return __extends(t,e),t.prototype.createMenuButton=function(){this.btn_start=new MenuButton("start_up_png","start_down_png","开始"),this.btn_rule=new MenuButton("rule_up_png","rule_down_png","规则"),this.btn_login=new MenuButton("user_up_png","user_down_png","登录"),this.btn_personal=new MenuButton("geren_up_png","geren_down_png","个人中心"),this.btn_giveUp=new MenuButton("ku_up_png","ku_down_png","认输"),this.btn_peace=new MenuButton("woshou_up_png","woshou_down_png","求和"),this.btn_chat=new MenuButton("liaotian_up_png","liaotian_down_png","聊天"),this.btn_room=new MenuButton("room_up_png","room_down_png","房间")},t.prototype.addButtonClickEvent=function(){this.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.removeThis,this),this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_start,this),this.btn_rule.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_rule,this),this.btn_login.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_login,this),this.btn_personal.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_personal,this),this.btn_giveUp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_giveUp,this),this.btn_peace.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_suePeace,this),this.btn_chat.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_chat,this),this.btn_room.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onclick_room,this)},t.prototype.refreshMenuButton=function(){var e=this.secondPage.scene.mediator.room;this.group_menu_btns.removeChildren(),e?e.roomStatus===con.roomStatus.gamestart?(this.group_menu_btns.addChild(this.btn_room),this.group_menu_btns.addChild(this.btn_giveUp),this.group_menu_btns.addChild(this.btn_peace),this.group_menu_btns.addChild(this.btn_rule),this.group_menu_btns.addChild(this.btn_personal),this.group_menu_btns.addChild(this.btn_chat)):(this.group_menu_btns.addChild(this.btn_start),this.group_menu_btns.addChild(this.btn_room),this.group_menu_btns.addChild(this.btn_rule),this.group_menu_btns.addChild(this.btn_personal),this.group_menu_btns.addChild(this.btn_login)):(this.group_menu_btns.addChild(this.btn_start),this.group_menu_btns.addChild(this.btn_rule),this.group_menu_btns.addChild(this.btn_personal),this.group_menu_btns.addChild(this.btn_login))},t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.onclick_start=function(){this.secondPage.hideAllSecondPage(),this.secondPage.scene.mediator.player.isLogin()?this.secondPage.popNetIndexView():this.secondPage.popLoginView()},t.prototype.onclick_rule=function(){this.secondPage.popRuleView()},t.prototype.onclick_statistics=function(){this.secondPage.popStatisticsView()},t.prototype.onclick_login=function(){this.secondPage.popLoginView()},t.prototype.onclick_personal=function(){this.secondPage.loginInterceptor()&&this.secondPage.popPersonalView()},t.prototype.onclick_giveUp=function(){this.secondPage.popGiveUpDialog()},t.prototype.onclick_suePeace=function(){this.secondPage.popSuePeaceDialog(0)},t.prototype.onclick_chat=function(){this.secondPage.popChatView()},t.prototype.onclick_room=function(){this.removeThis(),this.secondPage.popRoomView()},t}(eui.Component);__reflect(NetMenuView.prototype,"NetMenuView");var NetRoomView=function(e){function t(t){var i=e.call(this)||this;i.setIntervalId=0,i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/NetRoomViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.label_p11.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_player1,i),i.label_p21.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_player2,i),i.btn_ready.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_ready,i),i.btn_change.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_change,i),i.btn_leave.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_leave,i),i}return __extends(t,e),t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.onclick_ready=function(){var e=this.secondPage.scene.mediator.room;null!=e&&e.roomStatus===con.roomStatus.waitplayer&&this.secondPage.scene.ready()},t.prototype.onclick_change=function(){var e=this.secondPage.scene.mediator.room;if(null!=e&&e.roomStatus===con.roomStatus.waitplayer){var t=this;this.btn_change.enabled=!1,this.secondPage.scene.changeRoom(),setTimeout(function(){t.btn_change.enabled=!0},5e3)}},t.prototype.onclick_leave=function(){function e(){SceneNetWorking.shared.leaveRoom()}var t=this,i=this.secondPage.scene.mediator.room;if(null!=i&&i.roomStatus===con.roomStatus.gamestart){var s=new Dialog;return s.label_title.text="警告",s.label_content.text="您目前处于游戏中,确定要逃跑?",s.btn_confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,e,this),s.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.group_dialog.removeChildren()},this),s.verticalCenter="0",s.horizontalCenter="0",this.group_dialog.removeChildren(),void this.group_dialog.addChild(s)}e()},t.prototype.setBtnState=function(){var e=SceneNetWorking.shared.mediator.room;e.roomStatus===con.roomStatus.gamestart?(this.btn_ready.enabled=!1,this.btn_change.enabled=!1):(this.btn_ready.enabled=!0,this.btn_change.enabled=!0)},t.prototype.refreshRoomInfo=function(){var e=SceneNetWorking.shared.mediator.room;if(null!=e){this.label_room.text="房间编号:  "+e.id;var t=e.player1,i=e.player2;t?(this.label_p11.text=t.name,this.label_p12.text="胜率: "+t.getVictoryRateStr(),this.label_p13.text=this.getplayerStatusDescribe(t)):(this.label_p11.text="",this.label_p12.text="",this.label_p13.text=""),i?(this.label_p21.text=i.name,this.label_p22.text="胜率: "+i.getVictoryRateStr(),this.label_p23.text=this.getplayerStatusDescribe(i)):(this.label_p21.text="",this.label_p22.text="",this.label_p23.text=""),this.setBtnState()}},t.prototype.getplayerStatusDescribe=function(e){if(!e)return"";var t=e.playerStatus,i="";switch(t){case con.playerStatus.notReady:i=e.readyTimeCount>0?"未准备      "+e.readyTimeCount:"未准备";break;case con.playerStatus.ready:i="已准备";break;case con.playerStatus.start:i="游戏进行中";break;case con.playerStatus.end:i="游戏结束";break;case con.playerStatus.undistributed:i="未分配"}return i},t.prototype.onclick_player1=function(){var e=this.secondPage.scene.mediator.room;null!=e&&e.player1&&this.popPlayerInfo(e.player1)},t.prototype.onclick_player2=function(){var e=this.secondPage.scene.mediator.room;null!=e&&e.player2&&this.popPlayerInfo(e.player2)},t.prototype.popPlayerInfo=function(e){var t=new PlayerInfoView;t.setPlayerInfo(e),this.group_dialog.addChild(t)},t}(eui.Component);__reflect(NetRoomView.prototype,"NetRoomView");var NetRuleView=function(e){function t(){var t=e.call(this)||this;t.skinName="src/game/scenes/networking/second_page/NetRuleViewSkin.exml";var i=ChessboardPara.Shared();t.width=i.chessboardW,t.height=i.chessboardH,t.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,t.removeThisView,t);var s=32,r=30,o=28;return t.label_rule.textFlow=[{text:"”工兵扛军旗“规则:\n",style:{size:s,textColor:16748544,bold:!0}},{text:"    此玩法为翻棋玩法，地雷被工兵挖上不会消失，反而被工兵所用；军旗被工兵扛上游戏不会结束，军旗成为了工兵的杀人工具；炸弹会被排长俘获,变成自己阵营的棋子；该玩法意在双方进行攻防厮杀,而非进行夺棋厮杀。\n",style:{size:28,textColor:16777215}},{text:"    1.军棋棋盘：\n",style:{size:r,textColor:16748544,bold:!0}},{text:"       军棋棋盘包含铁路线、公路线，包括5个行营、23个兵站、2个大本营。在该玩法中,大本营等同于兵站。兵站是棋子的摆放位置；铁路线是部分棋子的快行线，只要在直线上或弯路棋子走步数不限；公路线是慢行线，每次只能移动一步；行营是棋子的安全岛，在行营中的棋子可以免受其他任何棋子的攻击。\n",style:{size:o,textColor:16777215}},{text:"    2.棋子类型：\n",style:{size:r,textColor:16748544,bold:!0}},{text:"       普通棋子类型有: 司令,军长,师长,旅长,团长,营长,连长,排长,工兵,炸弹,地雷,军旗,组合棋子类型有: 工兵+地雷,工兵+军旗,工兵+地雷+军旗,排长+炸弹，其中（地雷，军旗，炸弹为对方的）。\n",style:{size:o,textColor:16777215}},{text:"    3.杀棋规则：\n",style:{size:r,textColor:16748544,bold:!0}},{text:"      普通棋子大小：\n",style:{size:o,textColor:16748544,bold:!0}},{text:"       【司令】>【军长】>【师长】>【旅长】>【团长】>【营长】>【连长】>【排长】>【工兵】；【地雷】和【军旗】不能移动，【炸弹】可以移动,但是不能进入行营，【炸弹】可以炸掉除【排长】之外的棋子；相同的棋子相遇后同时消失。【工兵】遇到对方的【地雷】或【军旗】，将变成组合棋子【工兵+地雷】或【工兵+军旗】或【工兵+地雷+军旗】。【排长】遇到对方的【炸弹】变成组合棋子【排长+炸弹】。\n",style:{size:o,textColor:16777215}},{text:"      组合棋子大小：\n",style:{size:o,textColor:16748544,bold:!0}},{text:"       【工兵+地雷】可以炸掉比【工兵】大的单个棋子同时扔掉一个【地雷】,【工兵+军旗】可以杀掉比【工兵】大的单个棋子,【排长+炸弹】的威力与【炸弹】相同。【工兵+地雷】、【炸弹】、【排长+炸弹】可以炸掉己方的【地雷】、【军旗】，让对方的【工兵】无【地雷】可挖，无【军旗】可扛。由此【工兵】，【地雷】，【军旗】，【炸弹】，【排长】成为了双方关注的焦点。\n",style:{size:o,textColor:16777215}},{text:"    4.行棋规则：\n",style:{size:r,textColor:16748544,bold:!0}},{text:"     工兵及工兵的组合棋子可以在铁路线上在没有阻挡的情况下任意行棋；炸弹在铁路线上走直线,其余棋子在铁路线上每次只能移动一步(和公路线上一样)；所有棋子在公路线上只能移动一步。\n",style:{size:o,textColor:16777215}},{text:"    5.阵营选择：\n",style:{size:r,textColor:16748544,bold:!0}},{text:"     玩家依次进行翻棋，首先翻开的棋子的颜色为该玩家的阵营，然后双方进行厮杀。\n",style:{size:o,textColor:16777215}},{text:"    6.胜负规则：\n",style:{size:r,textColor:16748544,bold:!0}},{text:"      杀光对方的棋子或对方无棋可走方可胜利。\n",style:{size:o,textColor:16777215}},{text:"    7.玩法说明：\n",style:{size:r,textColor:16748544,bold:!0}},{text:"     游戏开始时，系统随机指定一人为先手，玩家第一次翻开棋子时，即确定了自己的阵营，轮到自己行琪时，点击自己的棋子即可选择，然后点击目的位置即可完成行琪。左右滑动组合棋子可查看该组合棋子的棋子组成，在移动时也可选择部分棋子进行移动。一方的下棋时间最长为30s，超过则由另一方进行行琪。\n",style:{size:o,textColor:16777215}}],t}return __extends(t,e),t.prototype.removeThisView=function(){this.stage.frameRate=30,this.parent.removeChild(this)},t}(eui.Component);__reflect(NetRuleView.prototype,"NetRuleView");var PersonalView=function(e){function t(t){var i=e.call(this)||this;i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/PersonalViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.btn_detail.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_detail,i),i.btn_edit.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_edit,i),i.refreshPlayerInfo(),i}return __extends(t,e),t.prototype.refreshPlayerInfo=function(){var e=SceneNetWorking.shared.mediator.player;this.label_username.text=e.name,e.loginUser&&e.loginUser.email&&(this.label_email.text=e.loginUser.email)},t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.onclick_detail=function(){var e=this.secondPage.scene.mediator.player;if(null!=e){var t=new PlayerInfoView;t.setPlayerInfo(e),this.group_dialog.addChild(t)}},t.prototype.onclick_edit=function(){this.secondPage.popEditPlayerInfoView()},t}(eui.Component);__reflect(PersonalView.prototype,"PersonalView");var RegisterView=function(e){function t(t){var i=e.call(this)||this;i.registerOutTimeId=0,i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/RegisterViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThis,i),i.btn_register.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_register,i),i.btn_back_login.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_back_login,i),i}return __extends(t,e),t.prototype.init=function(){this.removeWaitView(),this.setReisterMsg("")},t.prototype.onclick_back_login=function(){this.removeThis(),this.secondPage.popLoginView()},t.prototype.onclick_register=function(){var e=this.edit_register_userName.text,t=this.edit_register_userPwd.text,i=this.edit_register_userPwd2.text,s=this.edit_register_email.text,r="";if(e?e.length>6&&(r+="用户名不能超过6个字符!"):r+="请填写用户名!",t?i?t!=i&&(r+="两次密码不一致,请重新输入!"):r+="请填写确认密码!":r+="请填写密码!",s){var o=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;o.test(s)||(r+="无效的E-mail地址！")}if(r)return void this.setReisterMsg(r);var n={userName:e,pwd:t,email:s};this.addWaitView();var h=this;this.registerOutTimeId=setTimeout(function(){h.removeWaitView(),h.setReisterMsg("请求超时!")},3e4),this.secondPage.scene.mediator.register(n)},t.prototype.setReisterMsg=function(e){this.label_register_msg.text=e},t.prototype.registerRet=function(e){if(e)if(e.success){var t=this.edit_register_userName.text,i=this.edit_register_userPwd.text;egret.localStorage.setItem("userName",t),egret.localStorage.setItem("pwd",i),this.setReisterMsg("注册成功!"),this.removeThis(),this.secondPage.popNetIndexView()}else{var s=e.error;s&&this.setReisterMsg("注册失败! "+s)}},t.prototype.removeThis=function(){this.removeWaitView(),this.parent.removeChild(this)},t.prototype.addWaitView=function(){this.waitView||(this.waitView=new WaitView),this.addChild(this.waitView)},t.prototype.removeWaitView=function(){this.waitView&&(this.removeChild(this.waitView),this.waitView=null,this.clearRegisterTimeOut())},t.prototype.clearRegisterTimeOut=function(){this.registerOutTimeId&&(clearTimeout(this.registerOutTimeId),this.registerOutTimeId=0)},t}(eui.Component);__reflect(RegisterView.prototype,"RegisterView");var StatisticsView=function(e){function t(t){var i=e.call(this)||this;i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/StatisticsViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.rect_mask.addEventListener(egret.TouchEvent.TOUCH_TAP,i.removeThisView,i),i}return __extends(t,e),t.prototype.statisticsKilledChessNum=function(){var e=[con.chessType.rLeader,con.chessType.rJun,con.chessType.rShi,con.chessType.rLv,con.chessType.rTuan,con.chessType.rYing,con.chessType.rLian,con.chessType.rPai,con.chessType.rGong,con.chessType.rZha,con.chessType.rLei,con.chessType.rQi],t=[],i=[con.chessType.bLeader,con.chessType.bJun,con.chessType.bShi,con.chessType.bLv,con.chessType.bTuan,con.chessType.bYing,con.chessType.bLian,con.chessType.bPai,con.chessType.bGong,con.chessType.bZha,con.chessType.bLei,con.chessType.bQi],s=[],r=[],o=[],n=[],h=[],a=this.secondPage.scene.mediator.chessAttr,p=this.secondPage.scene.mediator.room;if(p){for(var u=p.createChessArr,c=p.chessboard,l=20;70>l;l++)-1===u.indexOf(l)&&r.push(l);c.forEach(function(e,t){e.forEach(function(e,t){0!==e&&e!==con.chessType.cover&&o.push(e)})}),r.forEach(function(e,t){-1===o.indexOf(e)&&n.push(e)}),n.forEach(function(e,t){var i=con.chessCtMap[e];h.push(i)}),e.forEach(function(e,i){var s=0;h.forEach(function(t,i){e===t&&s++}),t.push(s)}),i.forEach(function(e,t){var i=0;h.forEach(function(t,s){e===t&&i++}),s.push(i)})}var g=Util.sumArray(t),d=Util.sumArray(s);this.red_title_label.textFlow=[{text:"   红方阵亡的棋子:",style:{size:30,textColor:16777215,bold:!0}},{text:" "+g,style:{size:30,textColor:16748544,bold:!0}}],this.blue_title_label.textFlow=[{text:"   蓝方阵亡的棋子:",style:{size:30,textColor:16777215,bold:!0}},{text:" "+d,style:{size:30,textColor:6075903,bold:!0}}];var y=this,b=0;e.forEach(function(e,i){var s=t[i];if(s>0){var r=a.getChessObjByChess(e),o=r.description,n="    "+o+" * "+s;b%4===3&&(n+="\n"),b++,y.red_content_label.textFlow.push({text:n,style:{size:28,textColor:16748544}})}}),b=0,i.forEach(function(e,t){var i=s[t];if(i>0){var r=a.getChessObjByChess(e),o=r.description,n="    "+o+" * "+i;b%4===3&&(n+="\n"),b++,y.blue_content_label.textFlow.push({text:n,style:{size:28,textColor:6075903}})}})},t.prototype.removeThisView=function(){this.parent.removeChild(this)},t}(eui.Component);__reflect(StatisticsView.prototype,"StatisticsView");var SuePeaceDialog=function(e){function t(t){var i=e.call(this)||this;return i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/SuePeaceDialogSkin.exml",i.btn_suePeace.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_suePeace,i),i.btn_agree.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_agree,i),i.btn_reject.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_reject,i),i.popSuePeace(0),i}return __extends(t,e),t.prototype.popSuePeace=function(e){this.viewStack.selectedIndex=e},t.prototype.onclick_suePeace=function(){this.secondPage.scene.mediator.suePeace(!0,!0),this.removeThis()},t.prototype.onclick_agree=function(){this.secondPage.scene.mediator.suePeace(!0,!1),this.removeThis()},t.prototype.onclick_reject=function(){this.secondPage.scene.mediator.suePeace(!1,!1),this.removeThis()},t.prototype.removeThis=function(){this.parent.removeChild(this)},t}(eui.Panel);__reflect(SuePeaceDialog.prototype,"SuePeaceDialog");var VictoryView=function(e){function t(t){var i=e.call(this)||this;i.secondPage=t,i.skinName="src/game/scenes/networking/second_page/VictoryViewSkin.exml";var s=ChessboardPara.Shared();return i.width=s.chessboardW,i.height=s.chessboardH,i.btn_confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick_confirm,i),i.setVictory(),i}return __extends(t,e),t.prototype.onclick_confirm=function(){this.removeThis();var e=this.secondPage.scene.mediator.room;e?this.secondPage.popRoomView():this.secondPage.popNetIndexView()},t.prototype.removeThis=function(){this.parent.removeChild(this)},t.prototype.setVictory=function(){var e="",t="",i=this.secondPage.scene.mediator.player;if(i.victoryStatus!=con.victoryStatus.playing)i.victoryStatus===con.victoryStatus.win&&(t="您胜利了",e="shengli_up_png"),i.victoryStatus===con.victoryStatus.lose&&(t="您失败了",e="shibai_up_png"),i.victoryStatus===con.victoryStatus.draw&&(t="您战平了",e="pingju_up_png");else{var s=this.secondPage.scene.mediator.room;s.victoryStatus===con.victoryStatus.redwin&&(t="红方胜利了",e="shengli_up_png"),s.victoryStatus===con.victoryStatus.bluewin&&(t="蓝方胜利了",e="shibai_up_png"),s.victoryStatus===con.victoryStatus.draw&&(t="双方战平",e="pingju_up_png")}this.img_icon.source=e,this.label_message.text=t},t}(eui.Component);__reflect(VictoryView.prototype,"VictoryView");var SceneIndex=function(e){function t(){var t=e.call(this)||this;t.skinName="src/game/scenes/SceneIndexSkin.exml",t.btn_start2.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onclick_start2,t),t.btn_about.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onclick_about,t);var i=ChessboardPara.Shared();return t.width=i.chessboardW,t.height=i.chessboardH,t.init(),t}return __extends(t,e),t.Shared=function(){return null==t.shared&&(t.shared=new t),t.shared},t.prototype.init=function(){},t.prototype.onclick_start=function(){},t.prototype.onclick_start2=function(){var e=new NetworkMediator,t=new SceneNetWorking(e);e.initScene(t),this.parent.addChild(t),this.parent.removeChild(this)},t.prototype.onclick_about=function(){var e=new AboutView;this.parent.addChild(e)},t}(eui.Component);__reflect(SceneIndex.prototype,"SceneIndex");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){this.initSceneSize();var e=SceneIndex.Shared();this.addChild(e)},t.prototype.initSceneSize=function(){function e(){t&&(t=!1,setTimeout(function(){var e=document.body.scrollWidth,s=document.body.scrollHeight;if(s>e){var r=720/(e/s),o=ChessboardPara.Shared();o.init(720,r),i.stage.setContentSize(720,r)}else{var o=ChessboardPara.Shared();o.init(720,1200)}t=!0},1e3))}var t=!0,i=this;e(),window.addEventListener("resize",function(){e()})},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,s){function r(e){t.call(s,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(s))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);